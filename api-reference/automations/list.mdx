---
title: "Listar Automações"
api: "GET /api/automations"
description: "Lista todas as automações cadastradas da empresa"
---

<Tip>
Este endpoint retorna todas as automações configuradas, independentemente do status (ativas ou inativas).
</Tip>

## Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

<RequestExample>

```bash cURL
curl -X GET https://api.disparador.com/api/automations \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const response = await fetch('https://api.disparador.com/api/automations', {
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const automations = await response.json();
console.log(`Total de automações: ${automations.length}`);
console.log(`Ativas: ${automations.filter(a => a.isActive).length}`);
```

```python Python
import requests

response = requests.get(
    'https://api.disparador.com/api/automations',
    headers={'X-Access-Token': 'seu-access-token'}
)

automations = response.json()
for automation in automations:
    status = "Ativa" if automation['isActive'] else "Inativa"
    print(f"{automation['name']} - {status}")
```

```php PHP
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://api.disparador.com/api/automations");
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'X-Access-Token: seu-access-token'
]);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($ch);
$automations = json_decode($response, true);

foreach ($automations as $automation) {
    $status = $automation['isActive'] ? 'Ativa' : 'Inativa';
    echo "{$automation['name']} - {$status}\n";
}
?>
```

</RequestExample>

## Response

Array de objetos de automação, cada um contendo:

<ResponseField name="id" type="number">
  ID único da automação
</ResponseField>

<ResponseField name="name" type="string">
  Nome da automação
</ResponseField>

<ResponseField name="description" type="string">
  Descrição da automação
</ResponseField>

<ResponseField name="isActive" type="boolean">
  Se a automação está ativa
</ResponseField>

<ResponseField name="scheduleType" type="string">
  Tipo de agendamento (DAILY, WEEKLY, MONTHLY, CRON)
</ResponseField>

<ResponseField name="schedule" type="object">
  Configuração detalhada do agendamento
</ResponseField>

<ResponseField name="databaseConfigId" type="number">
  ID da configuração de banco de dados
</ResponseField>

<ResponseField name="evolutionConfigId" type="number">
  ID da configuração Evolution API
</ResponseField>

<ResponseField name="intervalMinSeconds" type="number">
  Intervalo mínimo entre mensagens
</ResponseField>

<ResponseField name="intervalMaxSeconds" type="number">
  Intervalo máximo entre mensagens
</ResponseField>

<ResponseField name="notificationPhone" type="string">
  Telefone para notificação
</ResponseField>

<ResponseField name="dedupStrategy" type="string">
  Estratégia de deduplicação
</ResponseField>

<ResponseField name="dedupCooldownDays" type="number">
  Dias de cooldown para deduplicação
</ResponseField>

<ResponseField name="sendLimitPerRun" type="number">
  Limite de envios por execução
</ResponseField>

<ResponseField name="lastRunAt" type="string">
  Data/hora da última execução
</ResponseField>

<ResponseField name="nextRunAt" type="string">
  Próxima execução prevista
</ResponseField>

<ResponseField name="createdAt" type="string">
  Data/hora de criação
</ResponseField>

<ResponseField name="updatedAt" type="string">
  Data/hora da última atualização
</ResponseField>

<ResponseExample>

```json 200 - Sucesso
[
  {
    "id": 1,
    "name": "Aniversariantes do Dia",
    "description": "Envia parabéns para aniversariantes",
    "isActive": true,
    "scheduleType": "DAILY",
    "schedule": {
      "timeOfDay": "09:00",
      "timezone": "America/Sao_Paulo",
      "weekdays": [2, 3, 4, 5, 6]
    },
    "databaseConfigId": 1,
    "evolutionConfigId": 1,
    "intervalMinSeconds": 5,
    "intervalMaxSeconds": 10,
    "notificationPhone": null,
    "dedupStrategy": "ONCE",
    "dedupCooldownDays": null,
    "sendLimitPerRun": 100,
    "lastRunAt": "2024-01-21T09:00:00",
    "nextRunAt": "2024-01-22T09:00:00",
    "createdAt": "2024-01-01T10:00:00",
    "updatedAt": "2024-01-15T14:30:00"
  },
  {
    "id": 2,
    "name": "Cobrança Semanal",
    "description": "Lembrete de pagamento pendente",
    "isActive": true,
    "scheduleType": "WEEKLY",
    "schedule": {
      "timeOfDay": "10:00",
      "timezone": "America/Sao_Paulo",
      "weekdays": [2]
    },
    "databaseConfigId": 1,
    "evolutionConfigId": 2,
    "intervalMinSeconds": 10,
    "intervalMaxSeconds": 20,
    "notificationPhone": "5511999999999",
    "dedupStrategy": "COOLDOWN_DAYS",
    "dedupCooldownDays": 7,
    "sendLimitPerRun": null,
    "lastRunAt": "2024-01-15T10:00:00",
    "nextRunAt": "2024-01-22T10:00:00",
    "createdAt": "2024-01-05T11:00:00",
    "updatedAt": "2024-01-05T11:00:00"
  },
  {
    "id": 3,
    "name": "Pesquisa Mensal",
    "description": "Pesquisa de satisfação",
    "isActive": false,
    "scheduleType": "MONTHLY",
    "schedule": {
      "timeOfDay": "14:00",
      "timezone": "America/Sao_Paulo",
      "dayOfMonth": 1
    },
    "databaseConfigId": 2,
    "evolutionConfigId": 1,
    "intervalMinSeconds": 5,
    "intervalMaxSeconds": 15,
    "notificationPhone": null,
    "dedupStrategy": "COOLDOWN_DAYS",
    "dedupCooldownDays": 30,
    "sendLimitPerRun": 500,
    "lastRunAt": "2024-01-01T14:00:00",
    "nextRunAt": null,
    "createdAt": "2023-12-20T09:00:00",
    "updatedAt": "2024-01-10T16:00:00"
  }
]
```

```json 401 - Token Inválido
{
  "message": "Access token inválido"
}
```

</ResponseExample>

## Filtros e Ordenação

<Note>
As automações são retornadas ordenadas por:
1. Data de criação (mais recentes primeiro)
2. Nome (ordem alfabética)

Não há paginação - todas as automações são retornadas de uma vez.
</Note>

## Exemplo de Dashboard

```javascript
// Função para criar dashboard de automações
async function getAutomationStats(accessToken) {
  const response = await fetch('https://api.disparador.com/api/automations', {
    headers: { 'X-Access-Token': accessToken }
  });
  
  const automations = await response.json();
  
  const stats = {
    total: automations.length,
    active: 0,
    inactive: 0,
    byScheduleType: {},
    nextToRun: null
  };
  
  let earliestNextRun = null;
  
  automations.forEach(automation => {
    // Contar ativas/inativas
    if (automation.isActive) {
      stats.active++;
    } else {
      stats.inactive++;
    }
    
    // Agrupar por tipo de agendamento
    stats.byScheduleType[automation.scheduleType] = 
      (stats.byScheduleType[automation.scheduleType] || 0) + 1;
    
    // Encontrar próxima execução
    if (automation.isActive && automation.nextRunAt) {
      const nextRun = new Date(automation.nextRunAt);
      if (!earliestNextRun || nextRun < earliestNextRun) {
        earliestNextRun = nextRun;
        stats.nextToRun = automation;
      }
    }
  });
  
  return stats;
}

// Usar
const stats = await getAutomationStats('seu-token');
console.log(`Total: ${stats.total} automações`);
console.log(`Ativas: ${stats.active}`);
console.log(`Próxima execução: ${stats.nextToRun?.name} às ${stats.nextToRun?.nextRunAt}`);
```

## Monitoramento

<CardGroup cols={2}>
  <Card title="Automações Inativas" icon="pause" color="#ef4444">
    Verifique regularmente automações inativas que podem precisar ser reativadas
  </Card>
  <Card title="Última Execução" icon="clock" color="#3b82f6">
    Monitore o campo lastRunAt para identificar automações que não estão executando
  </Card>
  <Card title="Próximas Execuções" icon="calendar" color="#16a34a">
    Use nextRunAt para planejar manutenções sem interromper automações
  </Card>
  <Card title="Estratégias de Dedup" icon="filter" color="#8b5cf6">
    Revise dedupStrategy para evitar envios duplicados desnecessários
  </Card>
</CardGroup>


