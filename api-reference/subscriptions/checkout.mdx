---
title: "Criar Sessão de Checkout"
api: "POST /api/subscriptions/checkout"
description: "Cria uma sessão de checkout para contratar um plano e criar uma conta"
---

<Info>
Este endpoint permite que novos usuários criem uma conta contratando um plano. Após o pagamento, a conta é criada automaticamente e as credenciais são enviadas por email.
</Info>

<Note>
Para empresas existentes que desejam mudar de plano, use o endpoint [Mudar Plano](/api-reference/subscriptions/change-plan).
</Note>

## Query Parameters

<ParamField query="priceId" type="string" required>
  ID do preço do plano na Stripe (ex: price_1234567890)
</ParamField>

<ParamField query="email" type="string" required>
  Email do novo usuário. Deve ser único no sistema
</ParamField>

<ParamField query="name" type="string" optional>
  Nome completo do usuário ou empresa
</ParamField>

<RequestExample>

```bash cURL
curl -X POST "https://api.disparador.com/api/subscriptions/checkout?priceId=price_123&email=novo@cliente.com&name=João Silva" \
  -H "Content-Type: application/json"
```

```javascript JavaScript
const params = new URLSearchParams({
  priceId: 'price_123',
  email: 'novo@cliente.com',
  name: 'João Silva'
});

const response = await fetch(`https://api.disparador.com/api/subscriptions/checkout?${params}`, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  }
});

const data = await response.json();

if (data.success) {
  // Redirecionar para o checkout
  window.location.href = data.data.checkout_url;
} else {
  console.error('Erro:', data.message);
}
```

```python Python
import requests

url = "https://api.disparador.com/api/subscriptions/checkout"
params = {
    "priceId": "price_123",
    "email": "novo@cliente.com",
    "name": "João Silva"
}

response = requests.post(url, params=params)
data = response.json()

if data.get('success'):
    print(f"URL do checkout: {data['data']['checkout_url']}")
else:
    print(f"Erro: {data.get('message')}")
```

</RequestExample>

<ResponseExample>

```json 200 - Sucesso
{
  "success": true,
  "message": "Sessão de checkout criada",
  "data": {
    "checkout_url": "https://checkout.stripe.com/c/pay/cs_test_...",
    "session_id": "cs_test_a1b2c3d4..."
  }
}
```

```json 400 - Email já existe
{
  "success": false,
  "message": "Já existe uma empresa cadastrada com este email"
}
```

```json 400 - Erro na Stripe
{
  "success": false,
  "message": "Erro ao criar sessão de checkout: {detalhes do erro}"
}
```

</ResponseExample>

## Fluxo de Criação de Conta

1. **Usuário acessa a landing page** e escolhe um plano
2. **Aplicação chama este endpoint** com o priceId e email
3. **Usuário é redirecionado** para o checkout seguro da Stripe
4. **Após pagamento aprovado**, a Stripe envia webhook
5. **Sistema cria a conta** automaticamente com:
   - Email fornecido
   - Senha temporária gerada
   - Tipo de registro: `stripe_subscription`
   - Assinatura ativa vinculada
6. **Email é enviado** com as credenciais de acesso

## Informações Importantes

<Warning>
Empresas criadas via checkout Stripe precisam manter uma assinatura ativa para acessar o sistema. Se a assinatura for cancelada ou o pagamento falhar, o acesso será suspenso.
</Warning>

<Info>
Empresas registradas com senha admin (tipo `admin_password`) têm acesso ilimitado e não precisam de assinatura.
</Info>

## Produtos Disponíveis

Os produtos e preços disponíveis podem ser listados através do endpoint [Listar Produtos](/api-reference/subscriptions/products).

## Próximos Passos

Após o usuário completar o checkout:

1. Ele receberá um email com as credenciais
2. Poderá fazer login usando o endpoint [Login](/api-reference/auth/login)
3. Poderá gerenciar sua assinatura através do [Portal de Faturamento](/api-reference/subscriptions/billing-portal)