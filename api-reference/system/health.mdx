---
title: "Health Check"
api: "GET /actuator/health"
description: "Verifica o status de saúde da API e seus componentes"
---

<Note>
O endpoint de health check fornece informações sobre o status de todos os componentes da API, incluindo banco de dados, Redis e Evolution API.
</Note>

## Visão Geral

O endpoint de health check é usado para monitorar a saúde da aplicação e verificar se todos os componentes estão funcionando corretamente.

## Headers

<ParamField header="X-Access-Token" type="string" optional>
  Token de acesso (opcional para health check)
</ParamField>

## Endpoints Disponíveis

<CardGroup cols={2}>
  <Card title="Health Geral" icon="heart" color="#16a34a">
    GET /actuator/health
  </Card>
  <Card title="Health Detalhado" icon="activity" color="#2563eb">
    GET /actuator/health/{component}
  </Card>
  <Card title="Info da Aplicação" icon="info" color="#7c3aed">
    GET /actuator/info
  </Card>
  <Card title="Métricas" icon="chart-bar" color="#ea580c">
    GET /actuator/metrics
  </Card>
</CardGroup>

## Health Check Geral

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health
```

```javascript JavaScript
const response = await fetch('https://{url-key}/api/actuator/health', {
  method: 'GET'
});

const health = await response.json();
console.log('Status da API:', health);
```

```python Python
import requests

response = requests.get('https://{url-key}/api/actuator/health')
health = response.json()
print('Status da API:', health)
```

```php PHP
<?php
$curl = curl_init();
curl_setopt_array($curl, [
    CURLOPT_URL => 'https://{url-key}/api/actuator/health',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_HTTPGET => true
]);

$response = curl_exec($curl);
curl_close($curl);

$health = json_decode($response, true);
print_r($health);
?>
```

</RequestExample>

<ResponseExample>

```json Sucesso (200 OK)
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP",
      "details": {
        "database": "PostgreSQL",
        "validationQuery": "SELECT 1"
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "6.2.0"
      }
    },
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 107374182400,
        "free": 53687091200,
        "threshold": 10485760
      }
    }
  }
}
```

```json Erro (503 Service Unavailable)
{
  "status": "DOWN",
  "components": {
    "db": {
      "status": "DOWN",
      "details": {
        "error": "Connection refused"
      }
    },
    "redis": {
      "status": "DOWN",
      "details": {
        "error": "Connection timeout"
      }
    }
  }
}
```

</ResponseExample>

## Health Check por Componente

### Banco de Dados

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health/db
```

</RequestExample>

<ResponseExample>

```json Banco de Dados OK
{
  "status": "UP",
  "details": {
    "database": "PostgreSQL",
    "validationQuery": "SELECT 1"
  }
}
```

</ResponseExample>

### Redis

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health/redis
```

</RequestExample>

<ResponseExample>

```json Redis OK
{
  "status": "UP",
  "details": {
    "version": "6.2.0"
  }
}
```

</ResponseExample>

## Informações da Aplicação

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/info
```

</RequestExample>

<ResponseExample>

```json Info da Aplicação
{
  "app": {
    "name": "disparador-api",
    "description": "Sistema de disparo de mensagens via WhatsApp",
    "version": "2.0.0",
    "java": {
      "version": "17.0.2",
      "vendor": "Oracle Corporation"
    }
  },
  "build": {
    "artifact": "disparador-api",
    "name": "disparador-api",
    "time": "2024-01-15T10:30:00.000Z",
    "version": "2.0.0",
    "group": "com.disparador"
  }
}
```

</ResponseExample>

## Métricas do Sistema

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/metrics
```

</RequestExample>

<ResponseExample>

```json Métricas Disponíveis
{
  "names": [
    "jvm.memory.used",
    "jvm.memory.max",
    "jvm.threads.live",
    "jvm.threads.peak",
    "process.cpu.usage",
    "process.uptime",
    "http.server.requests",
    "disparador.campaigns.active",
    "disparador.messages.sent",
    "disparador.messages.failed"
  ]
}
```

</ResponseExample>

### Métricas Específicas

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/metrics/disparador.campaigns.active
```

</RequestExample>

<ResponseExample>

```json Métrica de Campanhas Ativas
{
  "name": "disparador.campaigns.active",
  "description": "Número de campanhas ativas",
  "baseUnit": null,
  "measurements": [
    {
      "statistic": "VALUE",
      "value": 5.0
    }
  ],
  "availableTags": []
}
```

</ResponseExample>

## Códigos de Status

| Status | Descrição |
|--------|-----------|
| `UP` | Componente funcionando normalmente |
| `DOWN` | Componente com problema |
| `OUT_OF_SERVICE` | Componente fora de serviço |
| `UNKNOWN` | Status desconhecido |

## Monitoramento

### Health Check Automático

Configure seu sistema de monitoramento para verificar o health check a cada 30 segundos:

<RequestExample>

```bash cURL
# Verificar se a API está respondendo
curl -f https://{url-key}/api/actuator/health

# Verificar componentes específicos
curl -f https://{url-key}/api/actuator/health/db
curl -f https://{url-key}/api/actuator/health/redis
```

</RequestExample>

### Alertas Recomendados

<CardGroup cols={2}>
  <Card title="API Down" icon="alert-triangle" color="#dc2626">
    Status geral diferente de UP
  </Card>
  <Card title="Banco de Dados" icon="database" color="#2563eb">
    Componente db com status DOWN
  </Card>
  <Card title="Redis" icon="server" color="#7c3aed">
    Componente redis com status DOWN
  </Card>
  <Card title="Espaço em Disco" icon="hard-drive" color="#ea580c">
    Espaço livre abaixo de 10GB
  </Card>
</CardGroup>

## Troubleshooting

### Problemas Comuns

<CardGroup cols={2}>
  <Card title="Banco de Dados" icon="database" color="#dc2626">
    Verificar conexão PostgreSQL e credenciais
  </Card>
  <Card title="Redis" icon="server" color="#2563eb">
    Verificar se Redis está rodando na porta 6379
  </Card>
  <Card title="Evolution API" icon="message-circle" color="#7c3aed">
    Verificar conectividade com Evolution API
  </Card>
  <Card title="Memória" icon="cpu" color="#ea580c">
    Verificar uso de memória JVM
  </Card>
</CardGroup>

## Próximos Passos

<CardGroup cols={3}>
  <Card title="Monitoramento" icon="activity" href="/monitoring">
    Configure monitoramento completo
  </Card>
  <Card title="Troubleshooting" icon="wrench" href="/troubleshooting">
    Resolva problemas comuns
  </Card>
  <Card title="Configuração" icon="settings" href="/configuration">
    Configure variáveis de ambiente
  </Card>
</CardGroup> 