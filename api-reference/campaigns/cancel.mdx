---
title: "Cancelar Campanha"
api: "PUT /api/campaigns/{id}/cancel"
description: "Cancela permanentemente uma campanha"
---

<Tip>
Cancela uma campanha de forma permanente. Esta ação não pode ser desfeita.
</Tip>

<Warning>
O cancelamento é irreversível. Uma campanha cancelada não pode ser retomada.
</Warning>

## Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

## Path Parameters

<ParamField path="id" type="number" required>
  ID da campanha a ser cancelada
</ParamField>

<RequestExample>

```bash cURL
curl -X PUT https://api.disparador.com/api/campaigns/123/cancel \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const campaignId = 123;

// Confirmar antes de cancelar
if (confirm('Tem certeza que deseja cancelar esta campanha? Esta ação não pode ser desfeita.')) {
  const response = await fetch(`https://api.disparador.com/api/campaigns/${campaignId}/cancel`, {
    method: 'PUT',
    headers: {
      'X-Access-Token': 'seu-access-token'
    }
  });
  
  const result = await response.json();
  
  if (result.id) {
    console.log(`Campanha ${result.name} cancelada permanentemente`);
    console.log(`Total enviado antes do cancelamento: ${result.sentContacts}`);
    console.log(`Status final: ${result.status}`);
  } else {
    console.error('Erro:', result.message);
  }
}
```

```python Python
import requests

campaign_id = 123
url = f"https://api.disparador.com/api/campaigns/{campaign_id}/cancel"
headers = {
    'X-Access-Token': 'seu-access-token'
}

# Confirmar antes de cancelar
confirm = input(f"Cancelar campanha {campaign_id}? (s/n): ")

if confirm.lower() == 's':
    response = requests.put(url, headers=headers)
    result = response.json()
    
    if 'id' in result:
        print(f"Campanha '{result['name']}' cancelada permanentemente")
        print(f"Mensagens enviadas antes do cancelamento: {result['sentContacts']}")
        print(f"Status final: {result['status']}")
    else:
        print(f"Erro: {result.get('message')}")
else:
    print("Cancelamento abortado")
```

```php PHP
<?php
$campaignId = 123;
$url = "https://api.disparador.com/api/campaigns/{$campaignId}/cancel";

// Confirmar antes de cancelar
echo "Tem certeza que deseja cancelar a campanha {$campaignId}? (s/n): ";
$handle = fopen("php://stdin", "r");
$confirm = trim(fgets($handle));
fclose($handle);

if (strtolower($confirm) === 's') {
    $options = [
        'http' => [
            'header' => "X-Access-Token: seu-access-token\r\n",
            'method' => 'PUT'
        ]
    ];
    
    $context = stream_context_create($options);
    $result = file_get_contents($url, false, $context);
    $response = json_decode($result, true);
    
    if (isset($response['id'])) {
        echo "Campanha '{$response['name']}' cancelada permanentemente\n";
        echo "Total enviado: {$response['sentContacts']}\n";
        echo "Status: {$response['status']}\n";
    } else {
        echo "Erro: " . $response['message'] . "\n";
    }
} else {
    echo "Cancelamento abortado\n";
}
?>
```

</RequestExample>

## Response

Retorna os dados completos finais da campanha após cancelamento.

### Campos Principais

<ResponseField name="id" type="number">
  ID da campanha
</ResponseField>

<ResponseField name="name" type="string">
  Nome da campanha
</ResponseField>

<ResponseField name="description" type="string">
  Descrição da campanha
</ResponseField>

<ResponseField name="status" type="string">
  Novo status (será "CANCELLED")
</ResponseField>

<ResponseField name="type" type="string">
  Tipo da campanha (TEXT, MEDIA, POLL)
</ResponseField>

<ResponseField name="createdAt" type="string">
  Data/hora de criação
</ResponseField>

<ResponseField name="startedAt" type="string">
  Data/hora que iniciou (se aplicável)
</ResponseField>

<ResponseField name="completedAt" type="string">
  Data/hora do cancelamento (mesmo valor de cancelledAt)
</ResponseField>

### Estatísticas Finais

<ResponseField name="totalContacts" type="number">
  Total de contatos que estavam na campanha
</ResponseField>

<ResponseField name="sentContacts" type="number">
  Total de mensagens enviadas antes do cancelamento
</ResponseField>

<ResponseField name="failedContacts" type="number">
  Total de falhas antes do cancelamento
</ResponseField>

<ResponseField name="pendingContacts" type="number">
  Contatos que não foram processados
</ResponseField>

<ResponseField name="progressPercentage" type="number">
  Percentual de progresso no momento do cancelamento
</ResponseField>

<ResponseField name="successRate" type="number">
  Taxa de sucesso final
</ResponseField>

### Outros Campos

Todos os demais campos da estrutura CampaignResponse também são retornados, incluindo:
- messageContent
- mediaType
- mediaUrl
- evolutionInstance
- evolutionConfig
- etc.

<ResponseField name="message" type="string">
  Mensagem de erro (apenas em caso de falha)
</ResponseField>

<ResponseExample>

```json 200 - Sucesso
{
  "id": 123,
  "name": "Campanha de Vendas",
  "description": null,
  "status": "CANCELLED",
  "type": "TEXT",
  "createdAt": "2024-01-20T10:00:00",
  "scheduledFor": null,
  "startedAt": "2024-01-20T10:01:00",
  "completedAt": "2024-01-20T17:00:00",
  "pausedAt": null,
  "totalContacts": 500,
  "sentContacts": 234,
  "failedContacts": 5,
  "pendingContacts": 261,
  "progressPercentage": 46.8,
  "successRate": 97.86,
  "estimatedCompletion": null,
  "messageContent": "Aproveite nossa promoção especial!",
  "mediaType": null,
  "mediaUrl": null,
  "fileName": null,
  "evolutionInstance": "whatsapp-01",
  "minInterval": 5,
  "maxInterval": 10,
  "notificationPhone": null,
  "pollData": null,
  "evolutionConfig": {
    "id": 1,
    "name": "WhatsApp Principal",
    "url": "https://evolution-api.exemplo.com",
    "instance": "whatsapp-01"
  },
  "message": null
}
```

```json 400 - Campanha Já Finalizada
{
  "message": "Campanhas concluídas não podem ser canceladas"
}
```

```json 400 - Campanha Já Cancelada
{
  "message": "Esta campanha já foi cancelada"
}
```

```json 400 - Campanha Não Encontrada
{
  "message": "Campanha não encontrada"
}
```

```json 400 - Token Inválido
{
  "message": "Access token inválido"
}
```

</ResponseExample>

## Quando Cancelar

Uma campanha pode ser cancelada quando está nos seguintes status:

<CardGroup cols={2}>
  <Card title="SCHEDULED" icon="calendar" color="#2563eb">
    Cancelar antes de iniciar
  </Card>
  <Card title="ACTIVE" icon="play" color="#16a34a">
    Interromper envio em andamento
  </Card>
  <Card title="PAUSED" icon="pause" color="#f59e0b">
    Desistir de campanha pausada
  </Card>
  <Card title="DRAFT" icon="file" color="#6b7280">
    Excluir rascunho não utilizado
  </Card>
</CardGroup>

## Não Pode Cancelar

<CardGroup cols={2}>
  <Card title="COMPLETED" icon="check-circle" color="#10b981">
    Já foi concluída
  </Card>
  <Card title="CANCELLED" icon="x-circle" color="#ef4444">
    Já está cancelada
  </Card>
</CardGroup>

## Consequências do Cancelamento

<Warning>
1. **Parada imediata** - Nenhuma nova mensagem será enviada
2. **Irreversível** - Não é possível retomar uma campanha cancelada
3. **Estatísticas preservadas** - Dados de envio são mantidos para consulta
4. **Contatos não notificados** - Destinatários restantes não receberão a mensagem
</Warning>

## Alternativas ao Cancelamento

Antes de cancelar, considere:

```javascript
// Função para avaliar se deve pausar ou cancelar
async function evaluateCampaignAction(campaignId, accessToken) {
  const response = await fetch(
    `https://api.disparador.com/api/campaigns/${campaignId}`,
    {
      headers: { 'X-Access-Token': accessToken }
    }
  );
  
  const campaign = await response.json();
  const progress = campaign.progressPercentage;
  
  if (progress < 10) {
    console.log('Menos de 10% enviado - considere cancelar');
    return 'CANCEL';
  } else if (progress < 50) {
    console.log('Entre 10-50% enviado - considere pausar e revisar');
    return 'PAUSE';
  } else {
    console.log('Mais de 50% enviado - considere deixar completar');
    return 'CONTINUE';
  }
}
```

## Auditoria

<Note>
Todos os cancelamentos são registrados com:
- Data e hora exata (completedAt)
- Estado da campanha no momento
- Estatísticas finais preservadas
- Histórico completo para consulta futura
</Note>