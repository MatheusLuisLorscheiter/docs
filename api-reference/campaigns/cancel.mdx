---
title: 'Cancelar Campanha'
description: 'Cancela uma campanha permanentemente'
---

# Cancelar Campanha

Cancela uma campanha permanentemente. Após cancelada, a campanha não pode ser retomada.

<Warning>
  Esta ação é irreversível. Uma campanha cancelada não pode ser retomada.
</Warning>

<Note>
  Você precisa de um access token válido no header `X-Access-Token` para usar este endpoint.
</Note>

## Endpoint

```http
PUT /api/campaigns/{id}/cancel
```

## Parâmetros da URL

<ParamField body="id" type="number" required={true}>
  ID único da campanha que deseja cancelar.
</ParamField>

## Headers

| Header | Tipo | Obrigatório | Descrição |
|--------|------|-------------|-----------|
| `X-Access-Token` | string | Sim | Token de acesso obtido no registro |

## Exemplo de Request

```bash
curl -X PUT https://api.disparador.com/api/campaigns/1/cancel \
  -H "X-Access-Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

## Response

### Sucesso (200 OK)

```json
{
  "id": 1,
  "name": "Campanha de Boas-vindas",
  "status": "CANCELLED",
  "totalContacts": 2,
  "sentMessages": 1,
  "failedMessages": 0,
  "createdAt": "2024-01-15T10:30:00",
  "message": null
}
```

### Erro (400 Bad Request)

```json
{
  "id": null,
  "name": null,
  "status": null,
  "totalContacts": 0,
  "sentMessages": 0,
  "failedMessages": 0,
  "message": "Campanha não pode ser cancelada"
}
```

## Campos da Resposta

| Campo | Tipo | Descrição |
|-------|------|-----------|
| `id` | number | ID único da campanha |
| `name` | string | Nome da campanha |
| `status` | string | Status atualizado: CANCELLED |
| `totalContacts` | number | Total de contatos na campanha |
| `sentMessages` | number | Mensagens enviadas com sucesso |
| `failedMessages` | number | Mensagens que falharam |
| `createdAt` | datetime | Data e hora de criação |
| `message` | string | Mensagem de erro (null em caso de sucesso) |

## Códigos de Erro

| Código | Descrição |
|--------|-----------|
| `400` | Access token inválido, campanha não encontrada ou não pode ser cancelada |
| `500` | Erro interno do servidor |

## Quando uma campanha pode ser cancelada

Uma campanha pode ser cancelada se estiver em qualquer status, exceto `CANCELLED` e `COMPLETED`:

- `ACTIVE` - Pode ser cancelada
- `PAUSED` - Pode ser cancelada
- `CANCELLED` - Já foi cancelada
- `COMPLETED` - Já foi finalizada

## Exemplos de Uso

### JavaScript

```javascript
const campaignId = 1;
const response = await fetch(`https://api.disparador.com/api/campaigns/${campaignId}/cancel`, {
  method: 'PUT',
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const result = await response.json();
console.log('Resultado:', result);
```

### Python

```python
import requests

campaign_id = 1
headers = {
    'X-Access-Token': 'seu-access-token'
}

response = requests.put(f'https://api.disparador.com/api/campaigns/{campaign_id}/cancel', headers=headers)
result = response.json()
print('Resultado:', result)
```

### PHP

```php
$campaign_id = 1;
$headers = [
    'X-Access-Token: seu-access-token'
];

$response = file_get_contents("https://api.disparador.com/api/campaigns/{$campaign_id}/cancel", false, stream_context_create([
    'http' => [
        'method' => 'PUT',
        'header' => implode("\r\n", $headers)
    ]
]));

$result = json_decode($response, true);
echo 'Resultado: ' . print_r($result, true);
```

## Fluxo de Gerenciamento

```mermaid
graph TD
    A[Campanha Criada] --> B[ACTIVE]
    B --> C[PAUSED]
    C --> B
    B --> D[CANCELLED]
    B --> E[COMPLETED]
    C --> D
```

## Exemplos de Erro

### Campanha já cancelada
```json
{
  "id": null,
  "name": null,
  "status": null,
  "totalContacts": 0,
  "sentMessages": 0,
  "failedMessages": 0,
  "message": "Campanha já foi cancelada"
}
```

### Campanha finalizada
```json
{
  "id": null,
  "name": null,
  "status": null,
  "totalContacts": 0,
  "sentMessages": 0,
  "failedMessages": 0,
  "message": "Campanha já foi finalizada"
}
```

### Campanha não encontrada
```json
{
  "id": null,
  "name": null,
  "status": null,
  "totalContacts": 0,
  "sentMessages": 0,
  "failedMessages": 0,
  "message": "Campanha não encontrada"
}
```

## Comportamento após cancelar

Quando uma campanha é cancelada:

1. **Status muda** para `CANCELLED`
2. **Processamento para** imediatamente
3. **Mensagens restantes** não são enviadas
4. **Métricas** são preservadas (mensagens já enviadas)
5. **Não pode ser retomada** - ação irreversível

## Diferenças entre Cancelar e Pausar

| Ação | Reversível | Mensagens Restantes | Status Final |
|------|------------|-------------------|--------------|
| **Pausar** | ✅ Sim | ✅ Preservadas | `PAUSED` |
| **Cancelar** | ❌ Não | ❌ Perdidas | `CANCELLED` |

## Próximos Passos

Após cancelar a campanha:

1. [Listar Campanhas](/api-reference/campaigns/list) - Veja todas as campanhas
2. [Criar Nova Campanha](/api-reference/campaigns/create) - Crie uma nova campanha
3. [Consultar Status](/api-reference/campaigns/get) - Verifique o status final 