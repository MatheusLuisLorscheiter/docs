---
title: "Consultar Campanha"
api: "GET /api/campaigns/{id}"
description: "Obt√©m informa√ß√µes detalhadas de uma campanha espec√≠fica"
---

<Tip>
Retorna todos os detalhes de uma campanha espec√≠fica, incluindo estat√≠sticas de envio em tempo real.
</Tip>

## Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

## Path Parameters

<ParamField path="id" type="number" required>
  ID da campanha
</ParamField>

<RequestExample>

```bash cURL
curl -X GET https://api.disparador.com/api/campaigns/123 \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const campaignId = 123;
const response = await fetch(`https://api.disparador.com/api/campaigns/${campaignId}`, {
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const campaign = await response.json();

if (campaign.id) {
  console.log(`Campanha: ${campaign.name}`);
  console.log(`Status: ${campaign.status}`);
  console.log(`Progresso: ${campaign.sentContacts}/${campaign.totalContacts}`);
  console.log(`Taxa de sucesso: ${campaign.successRate}%`);
} else {
  console.error('Erro:', campaign.message);
}
```

```python Python
import requests

campaign_id = 123
url = f"https://api.disparador.com/api/campaigns/{campaign_id}"
headers = {
    'X-Access-Token': 'seu-access-token'
}

response = requests.get(url, headers=headers)
campaign = response.json()

if 'id' in campaign:
    print(f"Campanha: {campaign['name']}")
    print(f"Status: {campaign['status']}")
    print(f"Total de contatos: {campaign['totalContacts']}")
    print(f"Enviadas: {campaign['sentContacts']}")
    print(f"Falhas: {campaign['failedContacts']}")
    print(f"Progresso: {campaign['progressPercentage']}%")
    print(f"Taxa de sucesso: {campaign['successRate']}%")
else:
    print(f"Erro: {campaign.get('message')}")
```

```php PHP
<?php
$campaignId = 123;
$url = "https://api.disparador.com/api/campaigns/{$campaignId}";
$headers = [
    'X-Access-Token: seu-access-token'
];

$options = [
    'http' => [
        'header' => implode("\r\n", $headers),
        'method' => 'GET'
    ]
];

$context = stream_context_create($options);
$result = file_get_contents($url, false, $context);
$campaign = json_decode($result, true);

if (isset($campaign['id'])) {
    echo "Campanha: " . $campaign['name'] . "\n";
    echo "Status: " . $campaign['status'] . "\n";
    echo "Progresso: " . $campaign['sentContacts'] . "/" . $campaign['totalContacts'] . "\n";
    echo "Taxa de sucesso: " . $campaign['successRate'] . "%\n";
} else {
    echo "Erro: " . $campaign['message'] . "\n";
}
?>
```

</RequestExample>

## Response

A estrutura de resposta inclui todos os detalhes da campanha:

### Campos Principais

<ResponseField name="id" type="number">
  ID √∫nico da campanha
</ResponseField>

<ResponseField name="name" type="string">
  Nome da campanha
</ResponseField>

<ResponseField name="description" type="string">
  Descri√ß√£o da campanha
</ResponseField>

<ResponseField name="status" type="string">
  Status atual da campanha
  - `DRAFT` - Rascunho
  - `SCHEDULED` - Agendada
  - `ACTIVE` - Em execu√ß√£o
  - `PAUSED` - Pausada
  - `COMPLETED` - Conclu√≠da
  - `CANCELLED` - Cancelada
  - `FAILED` - Falhou
</ResponseField>

<ResponseField name="type" type="string">
  Tipo da campanha (TEXT, MEDIA, POLL)
</ResponseField>

<ResponseField name="createdAt" type="string">
  Data/hora de cria√ß√£o
</ResponseField>

<ResponseField name="scheduledFor" type="string">
  Data/hora de agendamento (se aplic√°vel)
</ResponseField>

<ResponseField name="startedAt" type="string">
  Data/hora que iniciou o envio
</ResponseField>

<ResponseField name="completedAt" type="string">
  Data/hora que foi conclu√≠da
</ResponseField>

<ResponseField name="pausedAt" type="string">
  Data/hora que foi pausada (se aplic√°vel)
</ResponseField>

### Estat√≠sticas

<ResponseField name="totalContacts" type="number">
  Total de contatos na campanha
</ResponseField>

<ResponseField name="sentContacts" type="number">
  Quantidade de mensagens enviadas com sucesso
</ResponseField>

<ResponseField name="failedContacts" type="number">
  Quantidade de envios que falharam
</ResponseField>

<ResponseField name="pendingContacts" type="number">
  Quantidade de contatos pendentes
</ResponseField>

<ResponseField name="progressPercentage" type="number">
  Percentual de progresso (0-100)
</ResponseField>

<ResponseField name="successRate" type="number">
  Taxa de sucesso em percentual
</ResponseField>

<ResponseField name="estimatedCompletion" type="string">
  Estimativa de conclus√£o (se em execu√ß√£o)
</ResponseField>

### Dados da Campanha

<ResponseField name="messageContent" type="string">
  Conte√∫do da mensagem enviada
</ResponseField>

<ResponseField name="mediaType" type="string">
  Tipo de m√≠dia (image, video, audio, document)
</ResponseField>

<ResponseField name="mediaUrl" type="string">
  URL da m√≠dia anexada
</ResponseField>

<ResponseField name="fileName" type="string">
  Nome do arquivo de m√≠dia
</ResponseField>

<ResponseField name="evolutionInstance" type="string">
  Inst√¢ncia Evolution usada
</ResponseField>

<ResponseField name="minInterval" type="number">
  Intervalo m√≠nimo entre mensagens (segundos)
</ResponseField>

<ResponseField name="maxInterval" type="number">
  Intervalo m√°ximo entre mensagens (segundos)
</ResponseField>

<ResponseField name="notificationPhone" type="string">
  Telefone para notifica√ß√£o de conclus√£o
</ResponseField>

<ResponseField name="pollData" type="object">
  Dados da enquete (se for campanha de enquete)
</ResponseField>

<ResponseField name="evolutionConfig" type="object">
  Configura√ß√£o Evolution completa usada
</ResponseField>

<ResponseField name="message" type="string">
  Mensagem de erro (apenas em caso de falha)
</ResponseField>

<ResponseExample>

```json 200 - Campanha Ativa
{
  "id": 123,
  "name": "Promo√ß√£o Black Friday",
  "description": null,
  "status": "ACTIVE",
  "type": "MEDIA",
  "createdAt": "2024-01-20T14:00:00",
  "scheduledFor": null,
  "startedAt": "2024-01-20T14:01:00",
  "completedAt": null,
  "pausedAt": null,
  "totalContacts": 500,
  "sentContacts": 234,
  "failedContacts": 5,
  "pendingContacts": 261,
  "progressPercentage": 46.8,
  "successRate": 97.86,
  "estimatedCompletion": "2024-01-20T16:30:00",
  "messageContent": "üéâ Black Friday chegou! At√© 70% OFF em todos os produtos. Acesse: www.exemplo.com",
  "mediaType": "image",
  "mediaUrl": "https://exemplo.com/black-friday.jpg",
  "fileName": "black-friday-promo.jpg",
  "evolutionInstance": "whatsapp-01",
  "minInterval": 5,
  "maxInterval": 10,
  "notificationPhone": "5511999999999",
  "pollData": null,
  "evolutionConfig": {
    "id": 1,
    "name": "WhatsApp Principal",
    "url": "https://evolution-api.exemplo.com",
    "instance": "whatsapp-01"
  }
}
```

```json 200 - Campanha de Enquete
{
  "id": 124,
  "name": "Pesquisa de Satisfa√ß√£o",
  "description": null,
  "status": "COMPLETED",
  "type": "POLL",
  "createdAt": "2024-01-20T10:00:00",
  "scheduledFor": null,
  "startedAt": "2024-01-20T10:01:00",
  "completedAt": "2024-01-20T11:30:00",
  "pausedAt": null,
  "totalContacts": 100,
  "sentContacts": 98,
  "failedContacts": 2,
  "pendingContacts": 0,
  "progressPercentage": 100,
  "successRate": 97.96,
  "estimatedCompletion": null,
  "messageContent": null,
  "mediaType": null,
  "mediaUrl": null,
  "fileName": null,
  "evolutionInstance": "whatsapp-01",
  "minInterval": 10,
  "maxInterval": 20,
  "notificationPhone": null,
  "pollData": {
    "name": "Como voc√™ avalia nosso atendimento?",
    "options": ["Excelente", "Bom", "Regular", "Ruim"],
    "selectableCount": 1
  },
  "evolutionConfig": {
    "id": 1,
    "name": "WhatsApp Principal",
    "url": "https://evolution-api.exemplo.com",
    "instance": "whatsapp-01"
  }
}
```

```json 200 - Campanha Agendada
{
  "id": 125,
  "name": "Lembrete Consultas",
  "description": null,
  "status": "SCHEDULED",
  "type": "TEXT",
  "createdAt": "2024-01-20T15:00:00",
  "scheduledFor": "2024-01-25T09:00:00",
  "startedAt": null,
  "completedAt": null,
  "pausedAt": null,
  "totalContacts": 50,
  "sentContacts": 0,
  "failedContacts": 0,
  "pendingContacts": 50,
  "progressPercentage": 0,
  "successRate": 0,
  "estimatedCompletion": null,
  "messageContent": "Ol√° {PrimeiroNome}! Lembramos que sua consulta est√° agendada para amanh√£ √†s 10h.",
  "mediaType": null,
  "mediaUrl": null,
  "fileName": null,
  "evolutionInstance": "whatsapp-01",
  "minInterval": 5,
  "maxInterval": 10,
  "notificationPhone": null,
  "pollData": null,
  "evolutionConfig": {
    "id": 1,
    "name": "WhatsApp Principal",
    "url": "https://evolution-api.exemplo.com",
    "instance": "whatsapp-01"
  }
}
```

```json 400 - Campanha N√£o Encontrada
{
  "message": "Campanha n√£o encontrada"
}
```

```json 400 - Token Inv√°lido
{
  "message": "Access token inv√°lido"
}
```

</ResponseExample>

## Monitoramento em Tempo Real

```javascript
// Fun√ß√£o para monitorar progresso da campanha
async function monitorCampaign(campaignId, accessToken) {
  const checkProgress = async () => {
    const response = await fetch(
      `https://api.disparador.com/api/campaigns/${campaignId}`,
      {
        headers: { 'X-Access-Token': accessToken }
      }
    );
    
    const campaign = await response.json();
    
    if (campaign.status === 'ACTIVE') {
      console.log(`[${new Date().toLocaleTimeString()}] ${campaign.name}`);
      console.log(`Status: ${campaign.status}`);
      console.log(`Progresso: ${campaign.progressPercentage}% (${campaign.sentContacts}/${campaign.totalContacts})`);
      console.log(`Taxa de sucesso: ${campaign.successRate}%`);
      console.log(`Falhas: ${campaign.failedContacts}`);
      console.log(`Estimativa de conclus√£o: ${campaign.estimatedCompletion || 'Calculando...'}`);
      console.log('---');
      
      // Continuar monitorando
      setTimeout(checkProgress, 30000); // 30 segundos
    } else {
      console.log(`Campanha finalizada com status: ${campaign.status}`);
      console.log(`Total enviado: ${campaign.sentContacts}`);
      console.log(`Taxa de sucesso final: ${campaign.successRate}%`);
    }
  };
  
  checkProgress();
}

// Usar
monitorCampaign(123, 'seu-access-token');
```

## C√°lculo de M√©tricas

```javascript
function calculateCampaignMetrics(campaign) {
  const metrics = {
    successRate: campaign.successRate || 0,
    failureRate: 0,
    progress: campaign.progressPercentage || 0,
    estimatedTimeRemaining: null,
    messagesPerMinute: 0
  };
  
  // Taxa de falha
  if (campaign.sentContacts > 0) {
    metrics.failureRate = (campaign.failedContacts / campaign.sentContacts * 100).toFixed(2);
  }
  
  // Velocidade de envio
  if (campaign.startedAt && campaign.sentContacts > 0) {
    const elapsedMinutes = (new Date() - new Date(campaign.startedAt)) / 60000;
    metrics.messagesPerMinute = (campaign.sentContacts / elapsedMinutes).toFixed(2);
    
    // Tempo restante estimado
    const remaining = campaign.pendingContacts;
    if (metrics.messagesPerMinute > 0) {
      metrics.estimatedTimeRemaining = Math.ceil(remaining / metrics.messagesPerMinute);
    }
  }
  
  return metrics;
}

// Exemplo de uso
const metrics = calculateCampaignMetrics(campaign);
console.log(`Mensagens por minuto: ${metrics.messagesPerMinute}`);
console.log(`Tempo restante estimado: ${metrics.estimatedTimeRemaining} minutos`);
```

## Observa√ß√µes

<Note>
- A campanha deve pertencer √† empresa do token para ser acessada
- As estat√≠sticas s√£o atualizadas em tempo real durante o envio
- Campanhas antigas mant√™m o hist√≥rico completo de execu√ß√£o
- A estimativa de conclus√£o √© calculada com base na velocidade m√©dia de envio
</Note>