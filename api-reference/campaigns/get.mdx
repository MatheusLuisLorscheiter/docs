---
title: "Consultar Campanha"
api: "GET /api/campaigns/{id}"
description: "Obt√©m informa√ß√µes detalhadas de uma campanha espec√≠fica"
---

<Tip>
Retorna todos os detalhes de uma campanha espec√≠fica, incluindo estat√≠sticas de envio em tempo real.
</Tip>

## Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

## Path Parameters

<ParamField path="id" type="number" required>
  ID da campanha
</ParamField>

<RequestExample>

```bash cURL
curl -X GET https://api.disparador.com/api/campaigns/123 \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const campaignId = 123;
const response = await fetch(`https://api.disparador.com/api/campaigns/${campaignId}`, {
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const campaign = await response.json();

if (campaign.id) {
  console.log(`Campanha: ${campaign.name}`);
  console.log(`Status: ${campaign.status}`);
  console.log(`Progresso: ${campaign.sentCount}/${campaign.totalContacts}`);
  
  const progress = (campaign.sentCount / campaign.totalContacts * 100).toFixed(2);
  console.log(`${progress}% conclu√≠da`);
} else {
  console.error('Erro:', campaign.message);
}
```

```python Python
import requests

campaign_id = 123
url = f"https://api.disparador.com/api/campaigns/{campaign_id}"
headers = {
    'X-Access-Token': 'seu-access-token'
}

response = requests.get(url, headers=headers)
campaign = response.json()

if 'id' in campaign:
    print(f"Campanha: {campaign['name']}")
    print(f"Status: {campaign['status']}")
    print(f"Total de contatos: {campaign['totalContacts']}")
    print(f"Enviadas: {campaign['sentCount']}")
    print(f"Falhas: {campaign['failedCount']}")
    
    if campaign['totalContacts'] > 0:
        progress = (campaign['sentCount'] / campaign['totalContacts']) * 100
        print(f"Progresso: {progress:.2f}%")
else:
    print(f"Erro: {campaign.get('message')}")
```

```php PHP
<?php
$campaignId = 123;
$url = "https://api.disparador.com/api/campaigns/{$campaignId}";
$headers = [
    'X-Access-Token: seu-access-token'
];

$options = [
    'http' => [
        'header' => implode("\r\n", $headers),
        'method' => 'GET'
    ]
];

$context = stream_context_create($options);
$result = file_get_contents($url, false, $context);
$campaign = json_decode($result, true);

if (isset($campaign['id'])) {
    echo "Campanha: " . $campaign['name'] . "\n";
    echo "Status: " . $campaign['status'] . "\n";
    echo "Progresso: " . $campaign['sentCount'] . "/" . $campaign['totalContacts'] . "\n";
    
    if ($campaign['totalContacts'] > 0) {
        $progress = ($campaign['sentCount'] / $campaign['totalContacts']) * 100;
        echo number_format($progress, 2) . "% conclu√≠da\n";
    }
} else {
    echo "Erro: " . $campaign['message'] . "\n";
}
?>
```

</RequestExample>

## Response

<ResponseField name="id" type="number">
  ID √∫nico da campanha
</ResponseField>

<ResponseField name="name" type="string">
  Nome da campanha
</ResponseField>

<ResponseField name="status" type="string">
  Status atual da campanha
  - `DRAFT` - Rascunho
  - `SCHEDULED` - Agendada
  - `ACTIVE` - Em execu√ß√£o
  - `PAUSED` - Pausada
  - `COMPLETED` - Conclu√≠da
  - `CANCELLED` - Cancelada
  - `FAILED` - Falhou
</ResponseField>

<ResponseField name="companyId" type="number">
  ID da empresa propriet√°ria
</ResponseField>

<ResponseField name="totalContacts" type="number">
  Total de contatos na campanha
</ResponseField>

<ResponseField name="sentCount" type="number">
  Quantidade de mensagens enviadas com sucesso
</ResponseField>

<ResponseField name="failedCount" type="number">
  Quantidade de envios que falharam
</ResponseField>

<ResponseField name="message" type="string">
  Texto da mensagem enviada
</ResponseField>

<ResponseField name="mediaUrl" type="string">
  URL da m√≠dia anexada (se houver)
</ResponseField>

<ResponseField name="mediaType" type="string">
  Tipo de m√≠dia (image, video, audio, document)
</ResponseField>

<ResponseField name="pollData" type="object">
  Dados da enquete (se for campanha de enquete)
</ResponseField>

<ResponseField name="scheduledFor" type="string">
  Data/hora de agendamento (se aplic√°vel)
</ResponseField>

<ResponseField name="createdAt" type="string">
  Data/hora de cria√ß√£o
</ResponseField>

<ResponseField name="updatedAt" type="string">
  Data/hora da √∫ltima atualiza√ß√£o
</ResponseField>

<ResponseField name="startedAt" type="string">
  Data/hora que iniciou o envio
</ResponseField>

<ResponseField name="completedAt" type="string">
  Data/hora que foi conclu√≠da
</ResponseField>

<ResponseField name="pausedAt" type="string">
  Data/hora que foi pausada (se aplic√°vel)
</ResponseField>

<ResponseField name="cancelledAt" type="string">
  Data/hora que foi cancelada (se aplic√°vel)
</ResponseField>

<ResponseExample>

```json 200 - Campanha Ativa
{
  "id": 123,
  "name": "Promo√ß√£o Black Friday",
  "status": "ACTIVE",
  "companyId": 1,
  "totalContacts": 500,
  "sentCount": 234,
  "failedCount": 5,
  "message": "üéâ Black Friday chegou! At√© 70% OFF em todos os produtos. Acesse: www.exemplo.com",
  "mediaUrl": "https://exemplo.com/black-friday.jpg",
  "mediaType": "image",
  "pollData": null,
  "scheduledFor": null,
  "createdAt": "2024-01-20T14:00:00",
  "updatedAt": "2024-01-20T14:45:00",
  "startedAt": "2024-01-20T14:01:00",
  "completedAt": null,
  "pausedAt": null,
  "cancelledAt": null
}
```

```json 200 - Campanha de Enquete
{
  "id": 124,
  "name": "Pesquisa de Satisfa√ß√£o",
  "status": "COMPLETED",
  "companyId": 1,
  "totalContacts": 100,
  "sentCount": 98,
  "failedCount": 2,
  "message": null,
  "mediaUrl": null,
  "mediaType": null,
  "pollData": {
    "name": "Como voc√™ avalia nosso atendimento?",
    "options": ["Excelente", "Bom", "Regular", "Ruim"],
    "selectableCount": 1
  },
  "scheduledFor": null,
  "createdAt": "2024-01-20T10:00:00",
  "updatedAt": "2024-01-20T11:30:00",
  "startedAt": "2024-01-20T10:01:00",
  "completedAt": "2024-01-20T11:30:00",
  "pausedAt": null,
  "cancelledAt": null
}
```

```json 200 - Campanha Agendada
{
  "id": 125,
  "name": "Lembrete Consultas",
  "status": "SCHEDULED",
  "companyId": 1,
  "totalContacts": 50,
  "sentCount": 0,
  "failedCount": 0,
  "message": "Ol√° {PrimeiroNome}! Lembramos que sua consulta est√° agendada para amanh√£ √†s 10h.",
  "mediaUrl": null,
  "mediaType": null,
  "pollData": null,
  "scheduledFor": "2024-01-25T09:00:00",
  "createdAt": "2024-01-20T15:00:00",
  "updatedAt": "2024-01-20T15:00:00",
  "startedAt": null,
  "completedAt": null,
  "pausedAt": null,
  "cancelledAt": null
}
```

```json 400 - Campanha N√£o Encontrada
{
  "message": "Campanha n√£o encontrada ou n√£o pertence √† sua empresa"
}
```

```json 400 - Token Inv√°lido
{
  "message": "Access token inv√°lido"
}
```

</ResponseExample>

## Monitoramento em Tempo Real

```javascript
// Fun√ß√£o para monitorar progresso da campanha
async function monitorCampaign(campaignId, accessToken) {
  const checkProgress = async () => {
    const response = await fetch(
      `https://api.disparador.com/api/campaigns/${campaignId}`,
      {
        headers: { 'X-Access-Token': accessToken }
      }
    );
    
    const campaign = await response.json();
    
    if (campaign.status === 'ACTIVE') {
      const progress = (campaign.sentCount / campaign.totalContacts * 100).toFixed(2);
      console.log(`[${new Date().toLocaleTimeString()}] ${campaign.name}`);
      console.log(`Status: ${campaign.status}`);
      console.log(`Progresso: ${progress}% (${campaign.sentCount}/${campaign.totalContacts})`);
      console.log(`Falhas: ${campaign.failedCount}`);
      console.log('---');
      
      // Continuar monitorando
      setTimeout(checkProgress, 30000); // 30 segundos
    } else {
      console.log(`Campanha finalizada com status: ${campaign.status}`);
    }
  };
  
  checkProgress();
}

// Usar
monitorCampaign(123, 'seu-access-token');
```

## C√°lculo de M√©tricas

```javascript
function calculateCampaignMetrics(campaign) {
  const metrics = {
    successRate: 0,
    failureRate: 0,
    progress: 0,
    estimatedTimeRemaining: null,
    messagesPerMinute: 0
  };
  
  if (campaign.totalContacts > 0) {
    metrics.progress = (campaign.sentCount / campaign.totalContacts * 100).toFixed(2);
    metrics.successRate = ((campaign.sentCount - campaign.failedCount) / campaign.sentCount * 100).toFixed(2);
    metrics.failureRate = (campaign.failedCount / campaign.sentCount * 100).toFixed(2);
  }
  
  if (campaign.startedAt && campaign.sentCount > 0) {
    const elapsedMinutes = (new Date() - new Date(campaign.startedAt)) / 60000;
    metrics.messagesPerMinute = (campaign.sentCount / elapsedMinutes).toFixed(2);
    
    const remaining = campaign.totalContacts - campaign.sentCount;
    if (metrics.messagesPerMinute > 0) {
      metrics.estimatedTimeRemaining = Math.ceil(remaining / metrics.messagesPerMinute);
    }
  }
  
  return metrics;
}
```

## Observa√ß√µes

<Note>
- A campanha deve pertencer √† empresa do token para ser acessada
- As estat√≠sticas s√£o atualizadas em tempo real durante o envio
- Campanhas antigas mant√™m o hist√≥rico completo de execu√ß√£o
</Note>