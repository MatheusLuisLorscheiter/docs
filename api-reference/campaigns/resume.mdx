---
title: "Retomar Campanha"
api: "PUT /api/campaigns/{id}/resume"
description: "Retoma uma campanha pausada, continuando o envio de onde parou"
---

<Tip>
Retoma o envio de mensagens de uma campanha que foi pausada anteriormente.
</Tip>

## Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

## Path Parameters

<ParamField path="id" type="number" required>
  ID da campanha a ser retomada
</ParamField>

<RequestExample>

```bash cURL
curl -X PUT https://api.disparador.com/api/campaigns/123/resume \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const campaignId = 123;
const response = await fetch(`https://api.disparador.com/api/campaigns/${campaignId}/resume`, {
  method: 'PUT',
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const result = await response.json();

if (result.id) {
  console.log(`Campanha ${result.name} retomada com sucesso!`);
  console.log(`Status atual: ${result.status}`);
  console.log(`Mensagens restantes: ${result.pendingContacts}`);
  console.log(`Progresso: ${result.progressPercentage}%`);
} else {
  console.error('Erro:', result.message);
}
```

```python Python
import requests

campaign_id = 123
url = f"https://api.disparador.com/api/campaigns/{campaign_id}/resume"
headers = {
    'X-Access-Token': 'seu-access-token'
}

response = requests.put(url, headers=headers)
result = response.json()

if 'id' in result:
    print(f"Campanha '{result['name']}' retomada com sucesso!")
    print(f"Status: {result['status']}")
    print(f"Mensagens restantes: {result['pendingContacts']}")
    print(f"Progresso: {result['progressPercentage']}%")
else:
    print(f"Erro: {result.get('message')}")
```

```php PHP
<?php
$campaignId = 123;
$url = "https://api.disparador.com/api/campaigns/{$campaignId}/resume";

$options = [
    'http' => [
        'header' => "X-Access-Token: seu-access-token\r\n",
        'method' => 'PUT'
    ]
];

$context = stream_context_create($options);
$result = file_get_contents($url, false, $context);
$response = json_decode($result, true);

if (isset($response['id'])) {
    echo "Campanha '{$response['name']}' retomada com sucesso!\n";
    echo "Status: {$response['status']}\n";
    echo "Mensagens restantes: {$response['pendingContacts']}\n";
    echo "Progresso: {$response['progressPercentage']}%\n";
} else {
    echo "Erro: " . $response['message'] . "\n";
}
?>
```

</RequestExample>

## Response

Retorna os dados completos atualizados da campanha após retomar.

### Campos Principais

<ResponseField name="id" type="number">
  ID da campanha
</ResponseField>

<ResponseField name="name" type="string">
  Nome da campanha
</ResponseField>

<ResponseField name="description" type="string">
  Descrição da campanha
</ResponseField>

<ResponseField name="status" type="string">
  Novo status (será "ACTIVE")
</ResponseField>

<ResponseField name="type" type="string">
  Tipo da campanha (TEXT, MEDIA, POLL)
</ResponseField>

<ResponseField name="startedAt" type="string">
  Data/hora do início original
</ResponseField>

<ResponseField name="pausedAt" type="string">
  Será null após retomar
</ResponseField>

### Estatísticas

<ResponseField name="totalContacts" type="number">
  Total de contatos na campanha
</ResponseField>

<ResponseField name="sentContacts" type="number">
  Mensagens já enviadas
</ResponseField>

<ResponseField name="failedContacts" type="number">
  Mensagens que falharam
</ResponseField>

<ResponseField name="pendingContacts" type="number">
  Mensagens ainda pendentes
</ResponseField>

<ResponseField name="progressPercentage" type="number">
  Percentual de progresso
</ResponseField>

<ResponseField name="successRate" type="number">
  Taxa de sucesso atual
</ResponseField>

<ResponseField name="estimatedCompletion" type="string">
  Nova estimativa de conclusão
</ResponseField>

### Outros Campos

Todos os demais campos da estrutura CampaignResponse também são retornados, incluindo:
- messageContent
- mediaType
- mediaUrl
- evolutionInstance
- evolutionConfig
- etc.

<ResponseField name="message" type="string">
  Mensagem de erro (apenas em caso de falha)
</ResponseField>

<ResponseExample>

```json 200 - Sucesso
{
  "id": 123,
  "name": "Campanha de Vendas",
  "description": null,
  "status": "ACTIVE",
  "type": "TEXT",
  "createdAt": "2024-01-20T10:00:00",
  "scheduledFor": null,
  "startedAt": "2024-01-20T10:01:00",
  "completedAt": null,
  "pausedAt": null,
  "totalContacts": 500,
  "sentContacts": 234,
  "failedContacts": 5,
  "pendingContacts": 261,
  "progressPercentage": 46.8,
  "successRate": 97.86,
  "estimatedCompletion": "2024-01-20T18:30:00",
  "messageContent": "Aproveite nossa promoção especial!",
  "mediaType": null,
  "mediaUrl": null,
  "fileName": null,
  "evolutionInstance": "whatsapp-01",
  "minInterval": 5,
  "maxInterval": 10,
  "notificationPhone": null,
  "pollData": null,
  "evolutionConfig": {
    "id": 1,
    "name": "WhatsApp Principal",
    "url": "https://evolution-api.exemplo.com",
    "instance": "whatsapp-01"
  },
  "message": null
}
```

```json 400 - Campanha Não Pode Ser Retomada
{
  "message": "Apenas campanhas pausadas podem ser retomadas"
}
```

```json 400 - Campanha Não Encontrada
{
  "message": "Campanha não encontrada"
}
```

```json 400 - Token Inválido
{
  "message": "Access token inválido"
}
```

</ResponseExample>

## Regras de Negócio

<Warning>
- Apenas campanhas com status `PAUSED` podem ser retomadas
- A campanha continua exatamente de onde parou
- Mensagens já enviadas não são reenviadas
- O intervalo entre mensagens é mantido
- O campo pausedAt volta a ser null após retomar
</Warning>

## Continuação do Envio

Ao retomar uma campanha:

1. **Fila preservada** - Contatos não enviados permanecem na ordem original
2. **Estatísticas mantidas** - Contadores de sucesso/falha continuam
3. **Configurações iguais** - Intervalos e parâmetros são preservados
4. **Sem duplicação** - Sistema garante que não há reenvios

## Exemplo de Gerenciamento

```javascript
// Sistema de pausa/retomada automática por horário
async function manageBusinessHours(campaignId, accessToken) {
  const now = new Date();
  const hour = now.getHours();
  
  // Horário comercial: 9h às 18h
  const isBusinessHour = hour >= 9 && hour < 18;
  
  // Verificar status atual
  const statusResponse = await fetch(
    `https://api.disparador.com/api/campaigns/${campaignId}`,
    {
      headers: { 'X-Access-Token': accessToken }
    }
  );
  
  const campaign = await statusResponse.json();
  
  if (!isBusinessHour && campaign.status === 'ACTIVE') {
    // Pausar fora do horário comercial
    await fetch(
      `https://api.disparador.com/api/campaigns/${campaignId}/pause`,
      {
        method: 'PUT',
        headers: { 'X-Access-Token': accessToken }
      }
    );
    console.log('Campanha pausada - fora do horário comercial');
    
  } else if (isBusinessHour && campaign.status === 'PAUSED') {
    // Retomar no horário comercial
    const resumeResponse = await fetch(
      `https://api.disparador.com/api/campaigns/${campaignId}/resume`,
      {
        method: 'PUT',
        headers: { 'X-Access-Token': accessToken }
      }
    );
    const resumed = await resumeResponse.json();
    console.log('Campanha retomada - horário comercial');
    console.log(`Nova estimativa de conclusão: ${resumed.estimatedCompletion}`);
  }
}

// Executar a cada 30 minutos
setInterval(() => manageBusinessHours(123, 'seu-token'), 1800000);
```

## Boas Práticas

<CardGroup cols={2}>
  <Card title="Verificar Status" icon="search" color="#3b82f6">
    Sempre verifique o status antes de tentar retomar
  </Card>
  <Card title="Logs e Notificações" icon="bell" color="#8b5cf6">
    Registre quando e por que campanhas foram pausadas/retomadas
  </Card>
  <Card title="Horários Adequados" icon="clock" color="#16a34a">
    Retome campanhas em horários apropriados para melhor engajamento
  </Card>
  <Card title="Monitorar Após Retomar" icon="chart-line" color="#f59e0b">
    Acompanhe métricas para garantir que tudo está funcionando
  </Card>
</CardGroup>