---
title: "Criar Campanha"
api: "POST /api/campaigns"
description: "Cria uma nova campanha com disparo imediato ou agendado"
---

<Tip>
Cria uma nova campanha de disparo de mensagens via WhatsApp. Suporta texto, mídia, enquetes e agendamento.
</Tip>

<Warning>
Você precisa de um access token válido no header X-Access-Token para usar este endpoint.
</Warning>

## Headers

<ParamField header="Content-Type" type="string" required>
  application/json
</ParamField>

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso obtido no registro
</ParamField>

## Body

<ParamField body="name" type="string" required>
  Nome da campanha entre 2 e 100 caracteres
</ParamField>

<ParamField body="evolutionUrl" type="string" required>
  URL completa da sua Evolution API
</ParamField>

<ParamField body="evolutionApiKey" type="string" required>
  API Key da sua Evolution API
</ParamField>

<ParamField body="evolutionInstance" type="string" required>
  Nome da instância do WhatsApp
</ParamField>

<ParamField body="contacts" type="array" required>
  Lista de contatos que receberão a mensagem
  
  <Expandable title="contacts[]">
    <ParamField body="phoneNumber" type="string" required>
      Número de telefone no formato 5511999999999
    </ParamField>
    <ParamField body="name" type="string">
      Nome do contato para variáveis
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="message" type="string" conditionally_required>
  Conteúdo da mensagem com suporte a variáveis. Obrigatório exceto para enquetes
</ParamField>

<ParamField body="pollData" type="object">
  Dados da enquete (opcional - substitui message)
  
  <Expandable title="pollData">
    <ParamField body="title" type="string" required>
      Título da enquete (máximo 100 caracteres)
    </ParamField>
    <ParamField body="options" type="array" required>
      Opções da enquete (mínimo 2, máximo 12)
    </ParamField>
    <ParamField body="maxChoices" type="number">
      Número máximo de escolhas (padrão: 1)
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="mediaUrl" type="string">
  URL do arquivo de mídia ou dados em base64 (ex: data:image/jpeg;base64,...)
</ParamField>

<ParamField body="mediaType" type="string">
  Tipo de mídia: image, video, audio, document (detectado automaticamente se não fornecido)
</ParamField>

<ParamField body="fileName" type="string">
  Nome do arquivo para mídia (recomendado para base64)
</ParamField>

<ParamField body="caption" type="string">
  Legenda para mídia
</ParamField>

<ParamField body="scheduledFor" type="datetime">
  Data e hora para agendamento no formato yyyy-MM-dd'T'HH:mm (mínimo 5 minutos de antecedência)
</ParamField>

<ParamField body="intervalMinSeconds" type="number">
  Intervalo mínimo entre mensagens em segundos (padrão: 3)
</ParamField>

<ParamField body="intervalMaxSeconds" type="number">
  Intervalo máximo entre mensagens em segundos (padrão: 30)
</ParamField>

<ParamField body="notificationPhone" type="string">
  Número de telefone para receber notificação de conclusão da campanha
</ParamField>

<ParamField body="isTest" type="boolean">
  Marca a campanha como teste (padrão: false)
</ParamField>

<RequestExample>

```bash cURL - Mensagem Simples
curl -X POST https://api.exemplo.com/api/campaigns \
  -H "Content-Type: application/json" \
  -H "X-Access-Token: seu_access_token" \
  -d '{
    "name": "Campanha de Boas Vindas",
    "evolutionUrl": "https://evolution.exemplo.com",
    "evolutionApiKey": "sua_api_key",
    "evolutionInstance": "instancia_whatsapp",
    "message": "Olá {{PrimeiroNome}}! Bem-vindo à nossa empresa!",
    "contacts": [
      {
        "phoneNumber": "5511999999999",
        "name": "João Silva"
      }
    ],
    "intervalMinSeconds": 5,
    "intervalMaxSeconds": 15,
    "notificationPhone": "5511888888888"
  }'
```

```bash cURL - Enquete
curl -X POST https://api.exemplo.com/api/campaigns \
  -H "Content-Type: application/json" \
  -H "X-Access-Token: seu_access_token" \
  -d '{
    "name": "Pesquisa de Satisfação",
    "evolutionUrl": "https://evolution.exemplo.com",
    "evolutionApiKey": "sua_api_key",
    "evolutionInstance": "instancia_whatsapp",
    "pollData": {
      "title": "Como você avalia nosso atendimento?",
      "options": ["Excelente", "Bom", "Regular", "Ruim"],
      "maxChoices": 1
    },
    "contacts": [
      {
        "phoneNumber": "5511999999999",
        "name": "Maria Santos"
      }
    ]
  }'
```

```javascript JavaScript - Com Mídia
const response = await fetch('https://api.exemplo.com/api/campaigns', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-Access-Token': 'seu_access_token'
  },
  body: JSON.stringify({
    name: 'Promoção com Imagem',
    evolutionUrl: 'https://evolution.exemplo.com',
    evolutionApiKey: 'sua_api_key',
    evolutionInstance: 'instancia_whatsapp',
    message: 'Confira nossa promoção especial!',
    mediaUrl: 'https://exemplo.com/promo.jpg',
    caption: 'Válido até domingo',
    contacts: [
      {
        phoneNumber: '5511999999999',
        name: 'Pedro Costa'
      }
    ],
    intervalMinSeconds: 5,
    intervalMaxSeconds: 15
  })
});

const result = await response.json();
console.log('Campanha criada:', result);
```

```python Python - Agendada
import requests
from datetime import datetime, timedelta

# Agendar para 1 hora no futuro
scheduled_time = (datetime.now() + timedelta(hours=1)).strftime('%Y-%m-%dT%H:%M')

headers = {
    'Content-Type': 'application/json',
    'X-Access-Token': 'seu_access_token'
}

data = {
    'name': 'Lembrete Agendado',
    'evolutionUrl': 'https://evolution.exemplo.com',
    'evolutionApiKey': 'sua_api_key',
    'evolutionInstance': 'instancia_whatsapp',
    'message': 'Olá {{PrimeiroNome}}, não esqueça do seu compromisso amanhã!',
    'scheduledFor': scheduled_time,
    'contacts': [
        {
            'phoneNumber': '5511999999999',
            'name': 'Ana Paula'
        }
    ],
    'isTest': True  # Marcando como teste
}

response = requests.post(
    'https://api.exemplo.com/api/campaigns',
    headers=headers,
    json=data
)

result = response.json()
print('Campanha agendada:', result)
```

```php PHP - Base64
<?php
$headers = [
    'Content-Type: application/json',
    'X-Access-Token: seu_access_token'
];

// Converter imagem para base64
$imageData = base64_encode(file_get_contents('promocao.jpg'));
$base64Url = 'data:image/jpeg;base64,' . $imageData;

$data = [
    'name' => 'Campanha com Base64',
    'evolutionUrl' => 'https://evolution.exemplo.com',
    'evolutionApiKey' => 'sua_api_key',
    'evolutionInstance' => 'instancia_whatsapp',
    'message' => 'Documento importante anexado',
    'mediaUrl' => $base64Url,
    'fileName' => 'promocao.jpg',
    'contacts' => [
        [
            'phoneNumber' => '5511999999999',
            'name' => 'Carlos Mendes'
        ]
    ]
];

$curl = curl_init();
curl_setopt_array($curl, [
    CURLOPT_URL => 'https://api.exemplo.com/api/campaigns',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => $headers,
    CURLOPT_POSTFIELDS => json_encode($data)
]);

$response = curl_exec($curl);
curl_close($curl);

$result = json_decode($response, true);
print_r($result);
?>
```

</RequestExample>

<ResponseExample>

```json Sucesso - Campanha Imediata (200 OK)
{
  "id": 1,
  "name": "Campanha de Boas Vindas",
  "description": null,
  "status": "RUNNING",
  "type": "NORMAL",
  "scheduledFor": null,
  "startedAt": "2024-01-15T10:30:00",
  "completedAt": null,
  "pausedAt": null,
  "totalContacts": 1,
  "sentContacts": 0,
  "failedContacts": 0,
  "pendingContacts": 1,
  "progressPercentage": 0.0,
  "successRate": 0.0,
  "estimatedCompletion": "2024-01-15T10:31:00",
  "createdAt": "2024-01-15T10:30:00",
  "mediaType": null,
  "evolutionInstance": "instancia_whatsapp",
  "minInterval": 5,
  "maxInterval": 15,
  "messageContent": "Olá {{PrimeiroNome}}! Bem-vindo à nossa empresa!",
  "fileName": null,
  "message": null
}
```

```json Sucesso - Campanha com Enquete (200 OK)
{
  "id": 2,
  "name": "Pesquisa de Satisfação",
  "status": "RUNNING",
  "type": "POLL",
  "totalContacts": 1,
  "mediaType": "poll",
  "messageContent": "Como você avalia nosso atendimento?",
  "message": null
}
```

```json Sucesso - Campanha Agendada (200 OK)
{
  "id": 3,
  "name": "Lembrete Agendado",
  "status": "SCHEDULED",
  "type": "NORMAL",
  "scheduledFor": "2024-01-15T11:30:00",
  "startedAt": null,
  "totalContacts": 1,
  "message": null
}
```

```json Erro - Token Inválido (400)
{
  "message": "Access token inválido"
}
```

```json Erro - Agendamento Muito Próximo (400)
{
  "message": "Agendamento deve ter pelo menos 5 minutos de antecedência"
}
```

```json Erro - Mensagem Obrigatória (400)
{
  "message": "Mensagem é obrigatória quando não for enquete"
}
```

```json Erro - Intervalos Inválidos (400)
{
  "message": "Intervalo máximo deve ser maior ou igual ao intervalo mínimo"
}
```

</ResponseExample>

## Response

<ResponseField name="id" type="number">
  ID único da campanha criada
</ResponseField>

<ResponseField name="name" type="string">
  Nome da campanha
</ResponseField>

<ResponseField name="description" type="string">
  Descrição da campanha (pode ser null)
</ResponseField>

<ResponseField name="status" type="string">
  Status atual: DRAFT, SCHEDULED, RUNNING, PAUSED, COMPLETED, CANCELLED
</ResponseField>

<ResponseField name="type" type="string">
  Tipo da campanha: NORMAL, POLL, TEST
</ResponseField>

<ResponseField name="scheduledFor" type="datetime">
  Data e hora do agendamento (null para campanhas imediatas)
</ResponseField>

<ResponseField name="startedAt" type="datetime">
  Data e hora de início da execução
</ResponseField>

<ResponseField name="completedAt" type="datetime">
  Data e hora de conclusão (null se não finalizada)
</ResponseField>

<ResponseField name="pausedAt" type="datetime">
  Data e hora da pausa (null se não pausada)
</ResponseField>

<ResponseField name="totalContacts" type="number">
  Total de contatos na campanha
</ResponseField>

<ResponseField name="sentContacts" type="number">
  Contatos com mensagens enviadas com sucesso
</ResponseField>

<ResponseField name="failedContacts" type="number">
  Contatos com falha no envio
</ResponseField>

<ResponseField name="pendingContacts" type="number">
  Contatos pendentes de envio
</ResponseField>

<ResponseField name="progressPercentage" type="number">
  Percentual de progresso da campanha (0.0 a 100.0)
</ResponseField>

<ResponseField name="successRate" type="number">
  Taxa de sucesso da campanha (0.0 a 100.0)
</ResponseField>

<ResponseField name="estimatedCompletion" type="datetime">
  Estimativa de conclusão da campanha
</ResponseField>

<ResponseField name="createdAt" type="datetime">
  Data e hora de criação da campanha
</ResponseField>

<ResponseField name="mediaType" type="string">
  Tipo de mídia: text, image, video, audio, document, poll
</ResponseField>

<ResponseField name="evolutionInstance" type="string">
  Nome da instância Evolution usada
</ResponseField>

<ResponseField name="minInterval" type="number">
  Intervalo mínimo entre mensagens (segundos)
</ResponseField>

<ResponseField name="maxInterval" type="number">
  Intervalo máximo entre mensagens (segundos)
</ResponseField>

<ResponseField name="messageContent" type="string">
  Conteúdo da mensagem ou título da enquete
</ResponseField>

<ResponseField name="fileName" type="string">
  Nome do arquivo de mídia (se houver)
</ResponseField>

<ResponseField name="message" type="string">
  Mensagem de erro ou null em caso de sucesso
</ResponseField>

## Códigos de Erro

| Código | Descrição |
|--------|-----------|
| 400 | Dados inválidos, access token inválido ou erro de validação |
| 401 | Token de acesso não fornecido |
| 500 | Erro interno do servidor |

## Variáveis na Mensagem

Você pode usar variáveis na mensagem que serão substituídas pelos dados do contato:

<CardGroup cols={2}>
  <Card title="{{PrimeiroNome}}" icon="user" color="#16a34a">
    Primeiro nome do contato
  </Card>
  <Card title="{{NomeCompleto}}" icon="users" color="#6366f1">
    Nome completo do contato
  </Card>
</CardGroup>

**Exemplos de uso:**
```
Olá {{PrimeiroNome}}! Como você está?
```
```
Prezado(a) {{NomeCompleto}}, temos uma oferta especial para você!
```

## Tipos de Mídia Suportados

| Tipo | Descrição | Extensões | Tamanho Máximo |
|------|-----------|-----------|----------------|
| **image** | Imagens | jpg, jpeg, png, gif, webp, svg | 5MB |
| **video** | Vídeos | mp4, avi, mov, wmv, flv, webm, mkv, 3gp | 16MB |
| **audio** | Áudios | mp3, wav, ogg, m4a, aac, opus, amr | 16MB |
| **document** | Documentos | pdf, doc, docx, xls, xlsx, ppt, pptx, zip, rar, txt, csv | 100MB |

<Note>
**Detecção Automática**: O sistema detecta automaticamente o tipo de mídia e MIME type baseado na extensão do arquivo ou header base64.

**Suporte a Base64**: Arquivos podem ser enviados como dados base64 (ex: `data:image/jpeg;base64,...`) ou URLs.

**Áudio com Texto**: Para áudios, se uma mensagem de texto for fornecida, ela será enviada após o áudio com 1 segundo de intervalo.
</Note>

## Enquetes (Polls)

Para criar uma campanha com enquete, use o campo `pollData`:

<CardGroup cols={3}>
  <Card title="Título" icon="heading" color="#16a34a">
    Máximo 100 caracteres
  </Card>
  <Card title="Opções" icon="list" color="#6366f1">
    Mínimo 2, máximo 12 opções
  </Card>
  <Card title="Escolhas" icon="check-square" color="#8b5cf6">
    maxChoices define quantas opções podem ser selecionadas
  </Card>
</CardGroup>

## Validações

<CardGroup cols={2}>
  <Card title="Nome da Campanha" icon="text" color="#16a34a">
    Entre 2 e 100 caracteres
  </Card>
  <Card title="URL Evolution" icon="link" color="#6366f1">
    Deve ser uma URL válida completa
  </Card>
  <Card title="Contatos" icon="users" color="#8b5cf6">
    Mínimo 1 contato na lista
  </Card>
  <Card title="Formato do Telefone" icon="phone" color="#f59e0b">
    Formato: 5511999999999 (com código do país)
  </Card>
  <Card title="Intervalo de Mensagens" icon="clock" color="#dc2626">
    intervalMaxSeconds deve ser >= intervalMinSeconds
  </Card>
  <Card title="Agendamento" icon="calendar" color="#059669">
    Mínimo 5 minutos de antecedência, formato: yyyy-MM-dd'T'HH:mm
  </Card>
</CardGroup>

## Campanhas de Teste

<Note>
Defina `isTest: true` para marcar uma campanha como teste. Campanhas de teste são úteis para validação e não contam nas estatísticas principais.
</Note>

## Próximos Passos

Após criar sua campanha:

<CardGroup cols={3}>
  <Card title="Consultar Status" icon="magnifying-glass" href="/api-reference/campaigns/get">
    Verifique o progresso da campanha
  </Card>
  <Card title="Listar Campanhas" icon="list" href="/api-reference/campaigns/list">
    Veja todas as campanhas criadas
  </Card>
  <Card title="Pausar Campanha" icon="pause" href="/api-reference/campaigns/pause">
    Interrompa temporariamente o envio
  </Card>
</CardGroup>
