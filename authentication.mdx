---
title: "Autenticação"
description: "Como autenticar na API Disparador"
---

<Warning>
A API Disparador utiliza um sistema de autenticação simples baseado em tokens de acesso. Tokens não expiram e devem ser mantidos seguros.
</Warning>

## Visão Geral

Para usar a API, você precisa:

1. **Registre sua empresa** para obter um access token
2. **Use o token** no header `X-Access-Token` em todas as requisições  
3. **Tokens não expiram** - você pode regenerar quando necessário

## Registro de Empresa

<Note>
Endpoint para registrar sua empresa e obter o access token inicial.
</Note>

### Endpoint
```http
POST /api/auth/register
```

### Body Parameters

<ParamField body="name" type="string" optional>
  Nome da empresa (máximo 100 caracteres). Se não fornecido, será usado o nome do email
</ParamField>

<ParamField body="email" type="string" required>
  Email válido e único no sistema (formato: usuario@dominio.com)
</ParamField>

<ParamField body="password" type="string" required>
  Senha com mínimo de 6 caracteres. Recomendado incluir letras, números e símbolos
</ParamField>

<RequestExample>

```bash cURL
curl -X POST https://api.disparador.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Minha Empresa LTDA",
    "email": "contato@minhaempresa.com",
    "password": "senha123"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.disparador.com/api/auth/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    name: 'Minha Empresa LTDA',
    email: 'contato@minhaempresa.com',
    password: 'senha123'
  })
});

const result = await response.json();
console.log('Token:', result.accessToken);
```

```python Python
import requests

data = {
    'name': 'Minha Empresa LTDA',
    'email': 'contato@minhaempresa.com',
    'password': 'senha123'
}

response = requests.post(
    'https://api.disparador.com/api/auth/register',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
print('Token:', result.get('accessToken'))
```

```php PHP
<?php
$data = [
    'name' => 'Minha Empresa LTDA',
    'email' => 'contato@minhaempresa.com',
    'password' => 'senha123'
];

$curl = curl_init();
curl_setopt_array($curl, [
    CURLOPT_URL => 'https://api.disparador.com/api/auth/register',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => json_encode($data),
    CURLOPT_HTTPHEADER => ['Content-Type: application/json']
]);

$response = curl_exec($curl);
curl_close($curl);

$result = json_decode($response, true);
echo 'Token: ' . $result['accessToken'];
?>
```

</RequestExample>

<ResponseExample>

```json Sucesso (200 OK)
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "companyId": 1,
  "message": null
}
```

```json Erro - Email já em uso (400)
{
  "accessToken": null,
  "companyId": null,
  "message": "Email já está em uso"
}
```

```json Erro - Email inválido (400)
{
  "accessToken": null,
  "companyId": null,
  "message": "Email deve ter formato válido"
}
```

```json Erro - Senha curta (400)
{
  "accessToken": null,
  "companyId": null,
  "message": "Senha deve ter pelo menos 6 caracteres"
}
```

</ResponseExample>

### Response

<ResponseField name="accessToken" type="string">
  Token de acesso para autenticação nas requisições (null em caso de erro)
</ResponseField>

<ResponseField name="companyId" type="number">
  ID único da empresa registrada (null em caso de erro)
</ResponseField>

<ResponseField name="message" type="string">
  Mensagem de erro (null em caso de sucesso)
</ResponseField>

## Usando o Access Token

Após obter o access token no registro, use-o no header `X-Access-Token` em todas as requisições:

<RequestExample>

```bash cURL
curl -X GET https://api.disparador.com/api/campaigns \
  -H "X-Access-Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

```javascript JavaScript
const headers = {
  'Content-Type': 'application/json',
  'X-Access-Token': 'seu-access-token'
};

const response = await fetch('https://api.disparador.com/api/campaigns', {
  method: 'GET',
  headers
});
```

```python Python
import requests

headers = {
    'Content-Type': 'application/json',
    'X-Access-Token': 'seu-access-token'
}

response = requests.get('https://api.disparador.com/api/campaigns', headers=headers)
```

```php PHP
<?php
$headers = [
    'Content-Type: application/json',
    'X-Access-Token: seu-access-token'
];

$context = stream_context_create([
    'http' => [
        'method' => 'GET',
        'header' => implode("\r\n", $headers)
    ]
]);

$response = file_get_contents('https://api.disparador.com/api/campaigns', false, $context);
?>
```

</RequestExample>

## Códigos de Erro

| Código | Descrição |
|--------|-----------|
| 400 | Dados inválidos ou email já em uso |
| 401 | Access token inválido ou ausente |
| 500 | Erro interno do servidor |

## Erro de Token Inválido

Quando um token inválido é usado, a API retorna:

```json
{
  "id": null,
  "name": null,
  "status": null,
  "totalContacts": 0,
  "sentMessages": 0,
  "failedMessages": 0,
  "message": "Access token inválido"
}
```

## Segurança e Boas Práticas

<CardGroup cols={2}>
  <Card title="Mantenha Seguro" icon="shield-check" color="#16a34a">
    Nunca compartilhe tokens em código público ou repositórios
  </Card>
  <Card title="Use HTTPS" icon="lock" color="#2563eb">
    Sempre use conexões seguras para todas as requisições
  </Card>
  <Card title="Variáveis de Ambiente" icon="key" color="#7c3aed">
    Armazene tokens em variáveis de ambiente, não no código
  </Card>
  <Card title="Monitore Uso" icon="chart-bar" color="#ea580c">
    Acompanhe as atividades da sua conta regularmente
  </Card>
</CardGroup>

### Armazenamento Seguro

<RequestExample>

```javascript JavaScript Correto
// ✅ Correto - Variável de ambiente
const token = process.env.API_TOKEN;

// ❌ Incorreto - Hardcoded
// const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
```

```python Python Correto
# ✅ Correto - Variável de ambiente
import os
token = os.environ.get('API_TOKEN')

# ❌ Incorreto - Hardcoded
# token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
```

```php PHP Correto
<?php
// ✅ Correto - Variável de ambiente
$token = getenv('API_TOKEN');

// ❌ Incorreto - Hardcoded
// $token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
?>
```

</RequestExample>

## Próximos Passos

Após configurar a autenticação:

<CardGroup cols={3}>
  <Card title="Criar Campanha" icon="plus" href="/api-reference/campaigns/create">
    Crie sua primeira campanha
  </Card>
  <Card title="Listar Campanhas" icon="list" href="/api-reference/campaigns/list">
    Veja todas suas campanhas
  </Card>
  <Card title="Documentação API" icon="book-open" href="/api-reference">
    Explore a documentação completa
  </Card>
</CardGroup>