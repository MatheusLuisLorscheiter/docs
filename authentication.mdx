---
title: "Autenticação"
description: "Como autenticar na API Disparador"
---

<Warning>
A API Disparador utiliza um sistema de autenticação baseado em tokens de acesso por empresa. Tokens não expiram automaticamente e devem ser mantidos seguros.
</Warning>

## Visão Geral

O sistema utiliza autenticação baseada em tokens:

1. **Registre uma empresa** (requer token de administrador)
2. **Faça login** com email e senha da empresa  
3. **Receba o token** de acesso na resposta
4. **Use o token** no header `X-Access-Token` em todas as requisições
5. **Tokens não expiram** - permanecem válidos indefinidamente

## Registro de Empresa

<Note>
Endpoint para registrar uma nova empresa. Requer token de administrador.
</Note>

### Endpoint
```http
POST /api/auth/register
```

### Headers

<ParamField header="ACCESS_TOKEN" type="string" required>
  Token de administrador no formato: Bearer {admin_password}
</ParamField>

### Body Parameters

<ParamField body="name" type="string" optional>
  Nome da empresa. Se não fornecido, será usado a parte antes do @ do email
</ParamField>

<ParamField body="email" type="string" required>
  Email da empresa (deve ser único)
</ParamField>

<ParamField body="password" type="string" required>
  Senha da empresa (mínimo 6 caracteres)
</ParamField>

<CodeGroup>

```bash cURL
curl -X POST https://api.disparador.com/api/auth/register \
  -H "Content-Type: application/json" \
  -H "ACCESS_TOKEN: Bearer sua_senha_admin" \
  -d '{
    "name": "Minha Empresa LTDA",
    "email": "contato@minhaempresa.com",
    "password": "senha123"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.disparador.com/api/auth/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'ACCESS_TOKEN': 'Bearer sua_senha_admin'
  },
  body: JSON.stringify({
    name: 'Minha Empresa LTDA',
    email: 'contato@minhaempresa.com',
    password: 'senha123'
  })
});

const result = await response.json();
console.log('Token:', result.accessToken);
```

</CodeGroup>

### Response

<ResponseExample>

```json Sucesso (200 OK)
{
  "accessToken": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "tokenType": "Access",
  "companyId": 1,
  "companyName": "Minha Empresa LTDA",
  "companyEmail": "contato@minhaempresa.com",
  "blockedContactsEnabled": true,
  "pollCampaignsEnabled": true,
  "expiresAt": null,
  "message": null
}
```

```json Erro - Token Admin Inválido (401)
{
  "accessToken": null,
  "tokenType": "Access",
  "companyId": null,
  "companyName": null,
  "companyEmail": null,
  "blockedContactsEnabled": null,
  "pollCampaignsEnabled": null,
  "expiresAt": null,
  "message": "Token de administrador inválido"
}
```

```json Erro - Email já existe (400)
{
  "accessToken": null,
  "tokenType": "Access",
  "companyId": null,
  "companyName": null,
  "companyEmail": null,
  "blockedContactsEnabled": null,
  "pollCampaignsEnabled": null,
  "expiresAt": null,
  "message": "Email já cadastrado"
}
```

</ResponseExample>

## Login

<Note>
Endpoint para autenticar e obter o access token da empresa.
</Note>

### Endpoint
```http
POST /api/auth/login
```

### Body Parameters

<ParamField body="email" type="string" required>
  Email cadastrado da empresa
</ParamField>

<ParamField body="password" type="string" required>
  Senha da empresa (mínimo 6 caracteres)
</ParamField>

<CodeGroup>

```bash cURL
curl -X POST https://api.disparador.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "contato@minhaempresa.com",
    "password": "senha123"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.disparador.com/api/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    email: 'contato@minhaempresa.com',
    password: 'senha123'
  })
});

const result = await response.json();
console.log('Token:', result.accessToken);
```

```python Python
import requests

data = {
    'email': 'contato@minhaempresa.com',
    'password': 'senha123'
}

response = requests.post(
    'https://api.disparador.com/api/auth/login',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
print('Token:', result.get('accessToken'))
```

```php PHP
<?php
$data = [
    'email' => 'contato@minhaempresa.com',
    'password' => 'senha123'
];

$curl = curl_init();
curl_setopt_array($curl, [
    CURLOPT_URL => 'https://api.disparador.com/api/auth/login',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => json_encode($data),
    CURLOPT_HTTPHEADER => ['Content-Type: application/json']
]);

$response = curl_exec($curl);
curl_close($curl);

$result = json_decode($response, true);
echo 'Token: ' . $result['accessToken'];
?>
```

</CodeGroup>

### Response

<ResponseExample>

```json Sucesso (200 OK)
{
  "accessToken": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "tokenType": "Access",
  "companyId": 1,
  "companyName": "Minha Empresa LTDA",
  "companyEmail": "contato@minhaempresa.com",
  "blockedContactsEnabled": true,
  "pollCampaignsEnabled": true,
  "expiresAt": null,
  "message": null
}
```

```json Erro - Credenciais inválidas (400)
{
  "accessToken": null,
  "tokenType": "Access",
  "companyId": null,
  "companyName": null,
  "companyEmail": null,
  "blockedContactsEnabled": null,
  "pollCampaignsEnabled": null,
  "expiresAt": null,
  "message": "Email ou senha incorretos"
}
```

```json Erro - Conta desativada (400)
{
  "accessToken": null,
  "tokenType": "Access",
  "companyId": null,
  "companyName": null,
  "companyEmail": null,
  "blockedContactsEnabled": null,
  "pollCampaignsEnabled": null,
  "expiresAt": null,
  "message": "Conta desativada. Entre em contato com o suporte"
}
```

</ResponseExample>

<ResponseField name="accessToken" type="string">
  Token de acesso para autenticação nas requisições
</ResponseField>

<ResponseField name="tokenType" type="string">
  Tipo do token (sempre "Access")
</ResponseField>

<ResponseField name="companyId" type="number">
  ID único da empresa
</ResponseField>

<ResponseField name="companyName" type="string">
  Nome da empresa
</ResponseField>

<ResponseField name="companyEmail" type="string">
  Email da empresa
</ResponseField>

<ResponseField name="blockedContactsEnabled" type="boolean">
  Se a funcionalidade de bloqueio inteligente está habilitada
</ResponseField>

<ResponseField name="pollCampaignsEnabled" type="boolean">
  Se a funcionalidade de enquetes está habilitada
</ResponseField>

<ResponseField name="expiresAt" type="string">
  Data de expiração do token (null = não expira)
</ResponseField>

<ResponseField name="message" type="string">
  Mensagem de erro (null em caso de sucesso)
</ResponseField>

## Verificar Autenticação

<Note>
Endpoint para verificar se o token está válido e obter dados da empresa.
</Note>

### Endpoint
```http
GET /api/auth/me
```

### Headers

<ParamField header="X-Access-Token" type="string" required>
  Token de acesso da empresa
</ParamField>

<CodeGroup>

```bash cURL
curl -X GET https://api.disparador.com/api/auth/me \
  -H "X-Access-Token: seu-access-token"
```

```javascript JavaScript
const response = await fetch('https://api.disparador.com/api/auth/me', {
  headers: {
    'X-Access-Token': 'seu-access-token'
  }
});

const result = await response.json();
console.log('Empresa:', result.companyName);
```

</CodeGroup>

<ResponseExample>

```json Sucesso (200 OK)
{
  "accessToken": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "tokenType": "Access",
  "companyId": 1,
  "companyName": "Minha Empresa LTDA",
  "companyEmail": "contato@minhaempresa.com",
  "blockedContactsEnabled": true,
  "pollCampaignsEnabled": true,
  "expiresAt": null,
  "message": null
}
```

```json Erro - Token inválido (400)
{
  "accessToken": null,
  "tokenType": "Access",
  "companyId": null,
  "companyName": null,
  "companyEmail": null,
  "blockedContactsEnabled": null,
  "pollCampaignsEnabled": null,
  "expiresAt": null,
  "message": "Access token inválido"
}
```

</ResponseExample>

## Usando o Access Token

Após obter o access token no login, use-o no header `X-Access-Token` em todas as requisições:

<CodeGroup>

```bash cURL
curl -X GET https://api.disparador.com/api/campaigns \
  -H "X-Access-Token: a1b2c3d4-e5f6-7890-abcd-ef1234567890"
```

```javascript JavaScript
const headers = {
  'Content-Type': 'application/json',
  'X-Access-Token': 'seu-access-token'
};

const response = await fetch('https://api.disparador.com/api/campaigns', {
  method: 'GET',
  headers
});
```

```python Python
import requests

headers = {
    'Content-Type': 'application/json',
    'X-Access-Token': 'seu-access-token'
}

response = requests.get('https://api.disparador.com/api/campaigns', headers=headers)
```

```php PHP
<?php
$headers = [
    'Content-Type: application/json',
    'X-Access-Token: seu-access-token'
];

$context = stream_context_create([
    'http' => [
        'method' => 'GET',
        'header' => implode("\r\n", $headers)
    ]
]);

$response = file_get_contents('https://api.disparador.com/api/campaigns', false, $context);
?>
```

</CodeGroup>

## Códigos de Erro

| Código | Descrição |
|--------|-----------|
| 400 | Dados inválidos, credenciais incorretas ou conta desativada |
| 401 | Access token inválido ou ausente |
| 403 | Sem permissão para acessar o recurso |
| 500 | Erro interno do servidor |

## Segurança e Boas Práticas

<CardGroup cols={2}>
  <Card title="Mantenha Seguro" icon="shield-check" color="#16a34a">
    Nunca compartilhe tokens em código público ou repositórios
  </Card>
  <Card title="Use HTTPS" icon="lock" color="#2563eb">
    Sempre use conexões seguras para todas as requisições
  </Card>
  <Card title="Variáveis de Ambiente" icon="key" color="#7c3aed">
    Armazene tokens em variáveis de ambiente, não no código
  </Card>
  <Card title="Monitore Uso" icon="chart-bar" color="#ea580c">
    Acompanhe as atividades da sua conta regularmente
  </Card>
</CardGroup>

### Armazenamento Seguro

<CodeGroup>

```javascript JavaScript
// ✅ Correto - Variável de ambiente
const token = process.env.API_TOKEN;

// ❌ Incorreto - Hardcoded
// const token = 'a1b2c3d4-e5f6-7890-abcd-ef1234567890';
```

```python Python
# ✅ Correto - Variável de ambiente
import os
token = os.environ.get('API_TOKEN')

# ❌ Incorreto - Hardcoded
# token = 'a1b2c3d4-e5f6-7890-abcd-ef1234567890'
```

```php PHP
<?php
// ✅ Correto - Variável de ambiente
$token = getenv('API_TOKEN');

// ❌ Incorreto - Hardcoded
// $token = 'a1b2c3d4-e5f6-7890-abcd-ef1234567890';
?>
```

</CodeGroup>

## Rate Limiting

O sistema implementa rate limiting por empresa:

<Note>
- **60 requisições por minuto** (padrão)
- **1000 requisições por hora** (padrão)
- Limites podem ser customizados por empresa
</Note>

### Headers de Rate Limit

Toda resposta inclui headers informativos:

| Header | Descrição |
|--------|-----------|
| `X-RateLimit-Limit` | Limite de requisições |
| `X-RateLimit-Remaining` | Requisições restantes |
| `X-RateLimit-Reset` | Timestamp de reset |

## Próximos Passos

Após configurar a autenticação:

<CardGroup cols={3}>
  <Card title="Interface Web" icon="browser" href="/frontend/login">
    Acesse a interface web
  </Card>
  <Card title="Criar Campanha" icon="plus" href="/api-reference/campaigns/create">
    Crie sua primeira campanha via API
  </Card>
  <Card title="Documentação API" icon="book-open" href="/api-reference">
    Explore todos os endpoints
  </Card>
</CardGroup>
