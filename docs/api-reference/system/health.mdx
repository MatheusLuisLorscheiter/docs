---
title: "Health Check"
api: "GET /api/actuator/health"
description: "Verifica o status de sa√∫de da API Disparador e seus componentes"
---

<Note>
O endpoint de health check fornece informa√ß√µes sobre o status de todos os componentes da API Disparador, incluindo banco de dados PostgreSQL, Redis e espa√ßo em disco.
</Note>

## Vis√£o Geral

O Spring Boot Actuator fornece este endpoint para monitorar a sa√∫de da aplica√ß√£o e verificar se todos os componentes est√£o funcionando corretamente. O endpoint est√° configurado para ser acessado publicamente sem autentica√ß√£o.

## Headers

Nenhum header √© obrigat√≥rio para este endpoint.

## Endpoint Principal

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health
```

```javascript JavaScript
const response = await fetch('https://{url-key}/api/actuator/health', {
  method: 'GET'
});

const health = await response.json();
console.log('Status da API:', health);
```

```python Python
import requests

response = requests.get('https://{url-key}/api/actuator/health')
health = response.json()
print('Status da API:', health)
```

```php PHP
<?php
$curl = curl_init();
curl_setopt_array($curl, [
    CURLOPT_URL => 'https://{url-key}/api/actuator/health',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_HTTPGET => true
]);

$response = curl_exec($curl);
curl_close($curl);

$health = json_decode($response, true);
print_r($health);
?>
```

</RequestExample>

<ResponseExample>

```json Sistema Saud√°vel (200 OK)
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP",
      "details": {
        "database": "PostgreSQL",
        "validationQuery": "SELECT 1"
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "6.2.0"
      }
    },
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 107374182400,
        "free": 53687091200,
        "threshold": 10485760,
        "path": "/app",
        "exists": true
      }
    },
    "ping": {
      "status": "UP"
    }
  }
}
```

```json Sistema com Problemas (503 Service Unavailable)
{
  "status": "DOWN",
  "components": {
    "db": {
      "status": "DOWN",
      "details": {
        "error": "Connection refused: Connection refused"
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "6.2.0"
      }
    },
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 107374182400,
        "free": 53687091200,
        "threshold": 10485760,
        "path": "/app",
        "exists": true
      }
    },
    "ping": {
      "status": "UP"
    }
  }
}
```

</ResponseExample>

## Health Check por Componente

### Banco de Dados PostgreSQL

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health/db
```

</RequestExample>

<ResponseExample>

```json Banco OK (200 OK)
{
  "status": "UP",
  "details": {
    "database": "PostgreSQL",
    "validationQuery": "SELECT 1"
  }
}
```

```json Banco com Problema (503 Service Unavailable)
{
  "status": "DOWN",
  "details": {
    "error": "Connection refused: Connection refused"
  }
}
```

</ResponseExample>

### Redis

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health/redis
```

</RequestExample>

<ResponseExample>

```json Redis OK (200 OK)
{
  "status": "UP",
  "details": {
    "version": "6.2.0"
  }
}
```

```json Redis com Problema (503 Service Unavailable)
{
  "status": "DOWN",
  "details": {
    "error": "Connection timeout"
  }
}
```

</ResponseExample>

### Espa√ßo em Disco

<RequestExample>

```bash cURL
curl -X GET https://{url-key}/api/actuator/health/diskSpace
```

</RequestExample>

<ResponseExample>

```json Espa√ßo OK (200 OK)
{
  "status": "UP",
  "details": {
    "total": 107374182400,
    "free": 53687091200,
    "threshold": 10485760,
    "path": "/app",
    "exists": true
  }
}
```

```json Espa√ßo Insuficiente (503 Service Unavailable)
{
  "status": "DOWN",
  "details": {
    "total": 107374182400,
    "free": 5242880,
    "threshold": 10485760,
    "path": "/app",
    "exists": true
  }
}
```

</ResponseExample>

## Response

<ResponseField name="status" type="string">
  Status geral do sistema: UP, DOWN, OUT_OF_SERVICE, UNKNOWN
</ResponseField>

<ResponseField name="components" type="object">
  Detalhes de cada componente monitorado
</ResponseField>

<ResponseField name="components.db.status" type="string">
  Status da conex√£o com PostgreSQL
</ResponseField>

<ResponseField name="components.db.details" type="object">
  Detalhes da conex√£o com o banco de dados
</ResponseField>

<ResponseField name="components.redis.status" type="string">
  Status da conex√£o com Redis
</ResponseField>

<ResponseField name="components.redis.details" type="object">
  Detalhes da conex√£o com Redis
</ResponseField>

<ResponseField name="components.diskSpace.status" type="string">
  Status do espa√ßo em disco
</ResponseField>

<ResponseField name="components.diskSpace.details" type="object">
  Detalhes do espa√ßo em disco dispon√≠vel
</ResponseField>

## C√≥digos de Status HTTP

| C√≥digo | Descri√ß√£o |
|--------|-----------|
| 200 | Sistema totalmente saud√°vel |
| 503 | Um ou mais componentes com problema |

## Status dos Componentes

| Status | Descri√ß√£o | Cor de Indica√ß√£o |
|--------|-----------|------------------|
| `UP` | Componente funcionando normalmente | üü¢ Verde |
| `DOWN` | Componente com problema | üî¥ Vermelho |
| `OUT_OF_SERVICE` | Componente fora de servi√ßo | üü° Amarelo |
| `UNKNOWN` | Status desconhecido | ‚ö´ Cinza |

## Monitoramento e Alertas

### Configura√ß√£o de Monitoramento

Configure seu sistema de monitoramento para verificar o health check:

<CardGroup cols={2}>
  <Card title="Intervalo de Verifica√ß√£o" icon="clock" color="#16a34a">
    A cada 30 segundos para status geral
  </Card>
  <Card title="Timeout" icon="timer" color="#2563eb">
    M√°ximo 10 segundos para resposta
  </Card>
  <Card title="Retry" icon="refresh-cw" color="#8b5cf6">
    3 tentativas antes de considerar DOWN
  </Card>
  <Card title="Alertas" icon="alert-triangle" color="#dc2626">
    Notificar imediatamente se DOWN
  </Card>
</CardGroup>

### Alertas Recomendados

<CardGroup cols={2}>
  <Card title="Sistema DOWN" icon="alert-triangle" color="#dc2626">
    **Cr√≠tico:** Status geral diferente de UP
  </Card>
  <Card title="Banco de Dados DOWN" icon="database" color="#dc2626">
    **Alto:** PostgreSQL inacess√≠vel
  </Card>
  <Card title="Redis DOWN" icon="server" color="#ea580c">
    **M√©dio:** Cache indispon√≠vel
  </Card>
  <Card title="Disco Cheio" icon="hard-drive" color="#f59e0b">
    **Alto:** Espa√ßo livre < 10MB
  </Card>
</CardGroup>

### Script de Monitoramento

<RequestExample>

```bash Script Bash
#!/bin/bash
# health-check.sh

HEALTH_URL="https://{url-key}/api/actuator/health"
WEBHOOK_URL="your-webhook-url"

response=$(curl -s -w "%{http_code}" -o /tmp/health.json "$HEALTH_URL")
http_code=${response: -3}

if [ "$http_code" != "200" ]; then
    echo "üö® API Disparador DOWN - HTTP $http_code"
    # Enviar alerta
    curl -X POST "$WEBHOOK_URL" \
        -H "Content-Type: application/json" \
        -d '{"text":"üö® API Disparador DOWN - HTTP '$http_code'"}'
else
    status=$(cat /tmp/health.json | grep -o '"status":"[^"]*"' | cut -d'"' -f4)
    if [ "$status" != "UP" ]; then
        echo "‚ö†Ô∏è  API Disparador $status"
        curl -X POST "$WEBHOOK_URL" \
            -H "Content-Type: application/json" \
            -d '{"text":"‚ö†Ô∏è API Disparador '$status'"}'
    else
        echo "‚úÖ API Disparador UP"
    fi
fi
```

```python Script Python
import requests
import json
import time

def check_health():
    url = "https://{url-key}/api/actuator/health"
    webhook = "your-webhook-url"
    
    try:
        response = requests.get(url, timeout=10)
        
        if response.status_code != 200:
            send_alert(f"üö® API DOWN - HTTP {response.status_code}", webhook)
            return False
            
        health = response.json()
        status = health.get('status', 'UNKNOWN')
        
        if status != 'UP':
            send_alert(f"‚ö†Ô∏è API {status}", webhook)
            return False
            
        print("‚úÖ API UP")
        return True
        
    except requests.exceptions.RequestException as e:
        send_alert(f"üö® API Unreachable: {str(e)}", webhook)
        return False

def send_alert(message, webhook):
    try:
        requests.post(webhook, json={"text": message})
        print(message)
    except:
        print(f"Failed to send alert: {message}")

if __name__ == "__main__":
    check_health()
```

</RequestExample>

## Troubleshooting

### Problemas Comuns

<CardGroup cols={2}>
  <Card title="PostgreSQL DOWN" icon="database" color="#dc2626">
    **Verificar:** Conex√£o, credenciais, firewall
    **Vari√°veis:** DB_HOST, DB_USER, DB_PASSWORD
  </Card>
  <Card title="Redis DOWN" icon="server" color="#ea580c">
    **Verificar:** Servi√ßo Redis, porta 6379
    **Vari√°veis:** REDIS_HOST, REDIS_PORT
  </Card>
  <Card title="Espa√ßo em Disco" icon="hard-drive" color="#f59e0b">
    **Verificar:** Logs antigos, cache, uploads
    **Limpeza:** docker system prune -a
  </Card>
  <Card title="Health Timeout" icon="clock" color="#2563eb">
    **Verificar:** Carga do sistema, queries lentas
    **Configura√ß√£o:** connection timeout
  </Card>
</CardGroup>

### Diagn√≥stico Detalhado

<RequestExample>

```bash Verificar Componentes
# Verificar todos os componentes
curl -s https://{url-key}/api/actuator/health | jq .

# Verificar apenas o banco
curl -s https://{url-key}/api/actuator/health/db | jq .

# Verificar apenas o Redis
curl -s https://{url-key}/api/actuator/health/redis | jq .

# Verificar espa√ßo em disco
curl -s https://{url-key}/api/actuator/health/diskSpace | jq .
```

</RequestExample>

## Outros Endpoints √öteis

<CardGroup cols={2}>
  <Card title="Informa√ß√µes da App" icon="info" color="#7c3aed">
    `GET /api/actuator/info`
    Vers√£o, build info, etc.
  </Card>
  <Card title="M√©tricas" icon="chart-bar" color="#ea580c">
    `GET /api/actuator/metrics`
    CPU, mem√≥ria, threads, etc.
  </Card>
  <Card title="Prometheus" icon="activity" color="#16a34a">
    `GET /api/actuator/prometheus`
    M√©tricas formato Prometheus
  </Card>
  <Card title="Configura√ß√£o" icon="settings" color="#2563eb">
    Endpoints configurados no application.yml
  </Card>
</CardGroup>

## Pr√≥ximos Passos

<CardGroup cols={3}>
  <Card title="Monitoramento" icon="activity" href="/monitoring">
    Configure monitoramento completo
  </Card>
  <Card title="Troubleshooting" icon="wrench" href="/troubleshooting">
    Resolva problemas comuns
  </Card>
  <Card title="Configura√ß√£o" icon="settings" href="/configuration">
    Configure vari√°veis de ambiente
  </Card>
</CardGroup> 